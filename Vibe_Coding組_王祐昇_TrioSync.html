<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fate Keys 命運節奏</title>
    <link rel="stylesheet" href="./Vibe_Coding組_王祐昇_運行程式及遊戲素材/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Audiowide&display=swap" rel="stylesheet">
</head>
<body>
    <!-- 粒子背景 Canvas -->
    <canvas id="particles-bg" aria-hidden="true"></canvas>
    
    <!-- 音訊解鎖遮罩 -->
    <div id="unlock-audio-mask">
        <div class="unlock-content">
            <div class="unlock-icon">🎵</div>
            <div class="unlock-text">點擊畫面以啟用音樂</div>
            <div class="unlock-hint">準備好體驗命運節奏了嗎？</div>
        </div>
    </div>
    
    <div id="main-wrapper">
        <!-- 倒數動畫遮罩 -->
        <div id="countdown-overlay">
            <div id="countdown-text">3</div>
        </div>
        
        <!-- 遊戲標題 -->
        <header>
            <h1 class="neon-logo">Fate Keys 命運節奏</h1>
            <p class="subtitle">基於經典音樂的電競節奏遊戲</p>
            <div id="audio-error-msg" role="alert"></div>
        </header>
        
        <!-- 音樂與難度選擇區 -->
        <section id="select-area">
            <div class="song-select">
                <h2 class="section-title">選擇歌曲</h2>
                <div class="song-card-list">
                    <div class="song-card" data-song="Champion.mp3" tabindex="0" aria-label="選擇歌曲 You're The Champion">
                        <div class="song-card-icon">🎵</div>
                        <div class="song-card-title">You're The Champion</div>
                        <div class="song-card-bpm">BPM: 128</div>
                    </div>
                    <div class="song-card" data-song="Bliss.mp3">
                        <div class="song-card-icon">🎶</div>
                        <div class="song-card-title">Bliss</div>
                        <div class="song-card-bpm">BPM: 140</div>
                    </div>
                    <div class="song-card" data-song="Canon.mp3">
                        <div class="song-card-icon">🎻</div>
                        <div class="song-card-title">Canon in D Major</div>
                        <div class="song-card-bpm">BPM: 120</div>
                    </div>
                    <div class="song-card" data-song="HappyBirthday.mp3">
                        <div class="song-card-icon">🎂</div>
                        <div class="song-card-title">Happy Birthday</div>
                        <div class="song-card-bpm">BPM: 100</div>
                    </div>
                    <div class="song-card" data-song="MainTheme.mp3">
                        <div class="song-card-icon">🌟</div>
                        <div class="song-card-title">Main Theme</div>
                        <div class="song-card-bpm">BPM: 135</div>
                    </div>
                    <div class="song-card" data-song="MagicalMoments.mp3">
                        <div class="song-card-icon">✨</div>
                        <div class="song-card-title">Magical Moments</div>
                        <div class="song-card-bpm">BPM: 145</div>
                    </div>
                    <div class="song-card" data-song="Noise.mp3">
                        <div class="song-card-icon">🔊</div>
                        <div class="song-card-title">Noise</div>
                        <div class="song-card-bpm">BPM: 150</div>
                    </div>
                    <div class="song-card" data-song="HammerMASTER.mp3">
                        <div class="song-card-icon">🥁</div>
                        <div class="song-card-title">HammerMASTER</div>
                        <div class="song-card-bpm">BPM: 160</div>
                    </div>
                    <div class="song-card" data-song="InspiringDreams.mp3">
                        <div class="song-card-icon">🎷</div>
                        <div class="song-card-title">Inspiring Dreams</div>
                        <div class="song-card-bpm">BPM: 130</div>
                    </div>
                    <div class="song-card" data-song="inspiringguitar.mp3">
                        <div class="song-card-icon">🎸</div>
                        <div class="song-card-title">Guitar Rhythm</div>
                        <div class="song-card-bpm">BPM: 125</div>
                    </div>
                </div>
            </div>
            
            <!-- 難度選擇區 -->
            <div class="difficulty-select">
                <h2 class="section-title">選擇難度</h2>
                <div class="difficulty-btn-row">
                    <button class="difficulty-btn beginner" data-difficulty="beginner" tabindex="0" aria-label="選擇難度 Lv.1">
                        <div class="difficulty-level">Lv.1</div>
                        <div class="difficulty-name">初學者 Beginner</div>
                        <div class="difficulty-stars">★</div>
                    </button>
                    <button class="difficulty-btn casual" data-difficulty="casual" tabindex="0" aria-label="選擇難度 Lv.2">
                        <div class="difficulty-level">Lv.2</div>
                        <div class="difficulty-name">休閒玩家 Casual</div>
                        <div class="difficulty-stars">★★</div>
                    </button>
                    <button class="difficulty-btn hard" data-difficulty="hard" tabindex="0" aria-label="選擇難度 Lv.3">
                        <div class="difficulty-level">Lv.3</div>
                        <div class="difficulty-name">困難模式 Hard</div>
                        <div class="difficulty-stars">★★★</div>
                    </button>
                    <button class="difficulty-btn extreme" data-difficulty="extreme" tabindex="0" aria-label="選擇難度 Lv.4">
                        <div class="difficulty-level">Lv.4</div>
                        <div class="difficulty-name">極限挑戰 Extreme</div>
                        <div class="difficulty-stars">★★★★</div>
                    </button>
                    <button class="difficulty-btn master" data-difficulty="master" tabindex="0" aria-label="選擇難度 Lv.5">
                        <div class="difficulty-level">Lv.5</div>
                        <div class="difficulty-name">大師級 Master</div>
                        <div class="difficulty-stars">★★★★★</div>
                    </button>
                    <button class="difficulty-btn fate hidden-difficulty" data-difficulty="fate" tabindex="0" aria-label="選擇難度 Lv.6" disabled>
                        <div class="difficulty-level">Lv.6</div>
                        <div class="difficulty-name">命運之路 Fate Mode</div>
                        <div class="difficulty-stars">⭐⭐⭐⭐⭐✨</div>
                    </button>
                </div>
                <div id="miss-buffer-ui" class="miss-buffer-ui" style="display:none;"></div>
            </div>
            
            <div class="start-btn-container">
                <button id="start-btn" class="pulse-btn" tabindex="0" aria-label="開始遊戲">
                    <div class="start-btn-icon">🚀</div>
                    <div class="start-btn-text">開始遊戲</div>
                </button>
            </div>
        </section>
        
        <!-- 遊戲區域 -->
        <section id="game-area">
            <div class="game-header">
                <div id="timer-display">60</div>
                <div id="score-display">分數: 0</div>
                <div id="combo-display">0</div>
            </div>
            
            <canvas id="game-canvas"></canvas>
            
            <!-- 音頻可視化 -->
            <canvas id="audio-visualizer"></canvas>
            
            <div id="key-hints">
                <div class="key" data-key="D">D</div>
                <div class="key" data-key="F">F</div>
                <div class="key" data-key=" ">SPACE</div>
                <div class="key" data-key="J">J</div>
                <div class="key" data-key="K">K</div>
            </div>
            
            <!-- Combo 容器 -->
            <div id="combo-container"></div>
        </section>
        
        <!-- 結算畫面 -->
        <section id="result-screen">
            <h2 class="result-title">遊戲結束</h2>
            <div class="result-content">
                <div id="final-score" class="final-score"></div>
                <div id="final-grade" class="final-grade"></div>
            </div>
            <div class="result-buttons">
                <button id="restart-btn" class="action-btn" tabindex="0" aria-label="再玩一次">
                    <span class="btn-icon">🔄</span>
                    再玩一次
                </button>
                <button id="back-btn" class="action-btn" tabindex="0" aria-label="返回主選單">
                    <span class="btn-icon">🏠</span>
                    返回主選單
                </button>
            </div>
        </section>
    </div>
    
    <!-- 高對比模式切換按鈕 -->
    <button id="contrast-btn" class="action-btn" tabindex="0" aria-label="高對比模式" style="position: absolute; top: 1rem; left: 1rem; z-index: 10; width:160px; text-align:center; white-space:nowrap;">🌓 高對比</button>
    <!-- 遊戲說明按鈕（移到高對比下方） -->
    <button id="help-btn" class="action-btn" tabindex="0" aria-label="遊戲說明" style="position: absolute; top: 3.8rem; left: 1rem; z-index: 10; width:160px; text-align:center; white-space:nowrap;">📖 玩法說明</button>
    <!-- 新增排行榜按鈕 -->
    <button id="leaderboard-btn" class="action-btn" tabindex="0" aria-label="排行榜" style="position: absolute; top: 6.6rem; left: 1rem; z-index: 10; width:160px; text-align:center; white-space:nowrap;">🏆 排行榜</button>
    <!-- 遊戲規則顯示區（由JS控制顯示） -->
    <div id="help-modal" style="display:none;"></div>
    
    <!-- 載入/過場動畫區塊 -->
    <div id="loading-overlay" style="display:none;position:fixed;z-index:999999;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.85);align-items:center;justify-content:center;">
        <div class="loader"></div>
    </div>
    
    <!-- 新增獨立排行榜View -->
    <div id="leaderboard-view" style="display:none;position:fixed;z-index:10001;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.92);align-items:center;justify-content:center;flex-direction:column;">
        <div id="leaderboard-content" style="max-width:480px;width:90vw;background:rgba(0,0,0,0.85);border-radius:18px;padding:32px 16px 24px 16px;box-shadow:0 0 32px #0ff6;margin:0 auto;"></div>
        <button id="close-leaderboard-btn" class="action-btn" style="margin-top:24px;font-size:1.2em;">返回首頁</button>
    </div>
    
    <script src="./Vibe_Coding組_王祐昇_運行程式及遊戲素材/game.js"></script>
    <script src="./Vibe_Coding組_王祐昇_運行程式及遊戲素材/judgment.js"></script>
</body>
</html> 