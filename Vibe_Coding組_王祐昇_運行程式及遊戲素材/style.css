/* =============================== */
/* Fate Keys 命運節奏 - 現代化 UI 樣式 */
/* =============================== */

html, body {
  height: 100%;
  margin: 0;
  padding: 0;
  overflow-y: auto;
  overflow-x: hidden;
}

/* 基本重置與背景 */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    background: #0a0a1a;
    min-height: 100vh;
    font-family: 'Orbitron', 'Audiowide', '微軟正黑體', Arial, sans-serif;
    color: #fff;
}

/* 粒子背景 Canvas */
#particles-bg {
    position: fixed;
    top: 0; left: 0;
    width: 100vw;
    height: 100vh;
    z-index: 0;
    pointer-events: none;
    display: block;
    background: radial-gradient(circle at 50% 50%, #0D0E52 0%, #1C1C80 30%, #2A1B3D 70%, #000 100%);
}

/* 深空背景增強效果 */
body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: -1;
    background: 
        radial-gradient(circle at 20% 30%, rgba(138, 43, 226, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 70%, rgba(108, 45, 199, 0.08) 0%, transparent 50%),
        radial-gradient(circle at 50% 50%, rgba(13, 14, 82, 0.15) 0%, transparent 70%);
    pointer-events: none;
    animation: deep-space-pulse 8s ease-in-out infinite;
}

@keyframes deep-space-pulse {
    0%, 100% { 
        opacity: 0.3;
        transform: scale(1);
    }
    50% { 
        opacity: 0.5;
        transform: scale(1.02);
    }
}

/* 主容器 */
#main-wrapper {
    position: relative;
    z-index: 1;
    background: linear-gradient(135deg, rgba(24,26,42,0.55) 0%, rgba(35,35,90,0.55) 100%) !important;
    background-blend-mode: lighten;
    border-radius: 30px;
    box-shadow: 0 8px 40px 0 rgba(0,0,0,0.18);
    padding: 1rem 0;
    width: 100vw;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    overflow-y: auto;
}

/* 音訊解鎖遮罩 */
#unlock-audio-mask {
    position: fixed;
    z-index: 99999;
    left: 0;
    top: 0;
    width: 100vw;
    height: 100vh;
    background: linear-gradient(135deg, rgba(0,0,0,0.9) 0%, rgba(10,10,26,0.95) 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.5s ease;
}

#unlock-audio-mask:hover {
    background: linear-gradient(135deg, rgba(0,0,0,0.8) 0%, rgba(10,10,26,0.9) 100%);
}

.unlock-content {
    text-align: center;
    animation: unlock-pulse 2s ease-in-out infinite;
}

.unlock-icon {
    font-size: 4rem;
    margin-bottom: 1rem;
    animation: unlock-bounce 1.5s ease-in-out infinite;
}

.unlock-text {
    font-size: 2rem;
    color: #0ff;
    text-shadow: 0 0 20px #0ff, 0 0 40px #39f;
    margin-bottom: 0.5rem;
    font-weight: bold;
}

.unlock-hint {
    font-size: 1.2rem;
    color: #4ecdc4;
    text-shadow: 0 0 10px #4ecdc4;
    opacity: 0.8;
}

@keyframes unlock-pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
}

@keyframes unlock-bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
}

/* 倒數動畫遮罩 */
#countdown-overlay {
    display: none;
    position: fixed;
    left: 0;
    top: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(0,0,0,0.8);
    z-index: 99999;
    justify-content: center;
    align-items: center;
    pointer-events: none;
}

#countdown-text {
    font-size: 8rem;
    color: #fff;
    text-shadow: 0 0 50px #0ff, 0 0 100px #39f;
    font-weight: bold;
    animation: countdown-pulse 1s ease-in-out;
}

@keyframes countdown-pulse {
    0% { transform: scale(0.5); opacity: 0; }
    50% { transform: scale(1.2); opacity: 1; }
    100% { transform: scale(1); opacity: 1; }
}

/* 標題區域 */
header {
    text-align: center;
    margin: 1rem 0 0.5rem 0;
    padding: 0.5rem;
    background: transparent !important;
}

/* 霓虹 Logo */
.neon-logo {
    font-size: 3.5rem;
    font-weight: bold;
    background: linear-gradient(90deg, #0ff, #f0f, #ff6f91, #fff700, #0ff);
    background-size: 400% 100%;
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    text-shadow: 
        0 0 20px #0ff,
        0 0 40px #39f,
        0 0 60px #f0f,
        0 0 80px #ff6f91;
    animation: neon-glow 3s linear infinite, title-rainbow 4s linear infinite;
    margin-bottom: 0.5rem;
}

@keyframes neon-glow {
    0%, 100% { 
        text-shadow: 
            0 0 20px #0ff,
            0 0 40px #39f,
            0 0 60px #f0f,
            0 0 80px #ff6f91;
    }
    50% { 
        text-shadow: 
            0 0 40px #f0f,
            0 0 60px #0ff,
            0 0 80px #39f,
            0 0 100px #fff700;
    }
}

@keyframes title-rainbow {
    0% { background-position: 0% 50%; }
    100% { background-position: 100% 50%; }
}

.subtitle {
    font-size: 1.3rem;
    color: #4ecdc4;
    text-shadow: 0 0 15px #4ecdc4;
    margin-bottom: 1rem;
    font-weight: 500;
}

/* 音訊錯誤訊息 */
#audio-error-msg {
    display: none;
    color: #ff6f91;
    text-align: center;
    font-size: 1.2rem;
    margin-top: 1rem;
    background: rgba(255,111,145,0.1);
    border: 2px solid #ff6f91;
    border-radius: 10px;
    padding: 1rem;
    box-shadow: 0 0 20px rgba(255,111,145,0.3);
    transition: opacity 0.5s;
    opacity: 0;
}
#audio-error-msg[style*="display: block"] {
    opacity: 1;
}

/* 選擇區域 */
#select-area {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 100%;
    max-width: 1200px;
    padding: 1rem;
    background: transparent !important;
    border-radius: 24px;
    box-shadow: 0 4px 32px 0 rgba(0,0,0,0.10);
    backdrop-filter: blur(8px);
    border: 1.5px solid rgba(255,255,255,0.18);
}

/* 區塊標題 */
.section-title {
    font-size: 2rem;
    color: #0ff;
    text-shadow: 0 0 20px #0ff;
    margin-bottom: 1.5rem;
    text-align: center;
    font-weight: bold;
}

/* 歌曲選擇 */
.song-select {
    margin-bottom: 1.5rem;
    width: 100%;
    background: transparent !important;
}

.song-card-list {
    display: flex;
    overflow-x: auto;
    gap: 0.8rem;
    padding: 0.5rem 0;
    scroll-snap-type: x mandatory;
    scrollbar-width: thin;
    scrollbar-color: #0ff #0a0a1a;
}

.song-card-list::-webkit-scrollbar {
    height: 8px;
}

.song-card-list::-webkit-scrollbar-track {
    background: #0a0a1a;
    border-radius: 4px;
}

.song-card-list::-webkit-scrollbar-thumb {
    background: linear-gradient(90deg, #0ff, #39f);
    border-radius: 4px;
}

.song-card {
    min-width: 160px; /* 原本 200px，0.8 倍 */
    height: 176px;    /* 原本 220px，0.8 倍 */
    background: linear-gradient(135deg, rgba(24,24,40,0.8) 0%, rgba(34,34,68,0.9) 100%);
    border: 2px solid #0ff;
    border-radius: 15px;
    padding: 1.2rem;  /* 原本 1.5rem，0.8 倍 */
    cursor: pointer;
    scroll-snap-align: center;
    transition: all 0.3s ease;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    box-shadow: 0 0 20px rgba(0,255,255,0.3);
    position: relative;
    overflow: hidden;
}

.song-card::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: linear-gradient(45deg, transparent, rgba(0,255,255,0.1), transparent);
    transform: rotate(45deg);
    transition: all 0.5s ease;
    opacity: 0;
}

.song-card:hover::before {
    opacity: 1;
    transform: rotate(45deg) translate(50%, 50%);
}

.song-card:hover, .song-card.active {
    transform: rotateZ(5deg) scale(1.05);
    border-color: #f0f;
    box-shadow: 
        0 0 30px rgba(0,255,255,0.5),
        0 0 60px rgba(240,0,255,0.3);
    background: linear-gradient(135deg, rgba(0,255,255,0.1) 0%, rgba(240,0,255,0.1) 100%);
}

.song-card.active {
    border: 3px solid #fff700;
    box-shadow: 0 0 40px #fff700, 0 0 80px #0ff;
    outline: 3px solid #0ff;
}

.song-card-list::after {
    content: '⇆';
    position: absolute;
    right: 1rem;
    top: 38%;
    transform: translateY(-50%);
    color: #0ff;
    font-size: 2rem;
    opacity: 0.5;
    pointer-events: none;
    animation: slideArrow 1.5s infinite alternate;
}
@keyframes slideArrow {
    0% { right: 1rem; opacity: 0.3; }
    100% { right: 2rem; opacity: 0.7; }
}

.song-card-icon {
    font-size: 2.4rem; /* 原本 3rem，0.8 倍 */
    margin-bottom: 1rem;
    filter: drop-shadow(0 0 10px #0ff);
    transition: all 0.3s ease;
}

.song-card:hover .song-card-icon {
    filter: drop-shadow(0 0 15px #f0f);
    transform: scale(1.1);
}

.song-card-title {
    font-size: 0.88rem; /* 原本 1.1rem，0.8 倍 */
    font-weight: bold;
    color: #fff;
    margin-bottom: 0.5rem;
    text-shadow: 0 0 5px #0ff;
}

.song-card-bpm {
    font-size: 0.72rem; /* 原本 0.9rem，0.8 倍 */
    color: #4ecdc4;
    opacity: 0.8;
}

/* 難度選擇 */
.difficulty-select {
    margin-bottom: 1.5rem;
    width: 100%;
    background: transparent !important;
}

.difficulty-btn-row {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.difficulty-btn {
    width: 128px;      /* 原本 160px，0.8 倍 */
    height: 140px !important;
    padding: 0.8rem;   /* 原本 1rem，0.8 倍 */
    border-radius: 12.8px; /* 原本 16px，0.8 倍 */
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    position: relative; /* for ::before */
    /*overflow: hidden;    防止 hover 動畫溢出 */
}

.difficulty-name {
    font-size: 0.72rem; /* 原本 0.9rem，0.8 倍 */
    text-align: center;
    word-break: break-word;
    line-height: 0.96rem; /* 原本 1.2rem，0.8 倍 */
}

.difficulty-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(45deg, transparent, rgba(255,255,255,0.2), transparent);
    opacity: 0;
    transition: opacity 0.3s ease;
}
.difficulty-btn:hover::before {
    opacity: 1;
}

/* 莫蘭迪色系難度底色 */
.difficulty-btn.easy {
  background: linear-gradient(135deg, #c7bca1, #a3a380); /* 抹茶色 */
  color: #4b4a3f;
}
.difficulty-btn.normal {
  background: linear-gradient(135deg, #52796f, #354f52); /* 深綠 */
  color: #e9f5e1;
}
.difficulty-btn.hard {
  background: linear-gradient(135deg, #74c0fc, #4ea8de); /* 水藍 */
  color: #1b263b;
}
.difficulty-btn.master {
  background: linear-gradient(135deg, #38b6ff, #60efbc); /* 土耳其藍 */
  color: #1b263b;
}
.difficulty-btn.ultimate {
  background: linear-gradient(135deg, #ff9770, #ff6f61); /* 橘紅 */
  color: #fff5e6;
}
.difficulty-btn.hidden-difficulty {
  background: linear-gradient(135deg, #e63946, #b5838d); /* 莫蘭迪紅+紫灰 */
  color: #fff0f3;
}

.difficulty-btn:hover,
.difficulty-btn.active {
    transform: scale(0.98);
    box-shadow:
        0 0 16px rgba(0, 255, 255, 0.4),
        0 0 24px rgba(240, 0, 255, 0.25);
}

.difficulty-btn:first-child {
    margin-left: 1rem;
}

.difficulty-icon {
    font-size: 1.2rem; /* 原本 1.5rem，0.8 倍 */
    margin-bottom: 0.3rem;
}

.difficulty-name {
    font-size: 0.8rem;
    margin-bottom: 0.2rem;
}

.difficulty-desc {
    font-size: 0.56rem; /* 原本 0.7rem，0.8 倍 */
    opacity: 0.8;
    display: none;
}
.difficulty-btn:hover .difficulty-desc {
    display: block;
}

.difficulty-stars {
    margin: 0.2rem 0 0.2rem 0;
    font-size: 1.04rem; /* 原本 1.3rem，0.8 倍 */
    letter-spacing: 0.1em;
    color: #ffe066;
    text-shadow: 0 0 8px #ffe066, 0 0 16px #fffae3;
    transition: transform 0.2s, color 0.3s;
    display: flex;
    justify-content: center;
    align-items: center;
    user-select: none;
}
.star {
    font-size: 1.04em; /* 原本 1.3em，0.8 倍 */
    margin: 0 0.05em;
    transition: color 0.3s, filter 0.3s;
}
.star-locked {
    color: #aaa !important;
    filter: grayscale(0.7) brightness(0.7);
    animation: locked-glow 1.2s infinite alternate;
}
@keyframes locked-glow {
    0% { text-shadow: 0 0 4px #888; }
    100% { text-shadow: 0 0 12px #bbb; }
}
.difficulty-btn.active .difficulty-stars,
.difficulty-btn:hover .difficulty-stars {
    animation: star-glow 1s infinite alternate;
    transform: scale(1.18);
}
@keyframes star-glow {
    0% { text-shadow: 0 0 8px #ffe066, 0 0 16px #fffae3; }
    100% { text-shadow: 0 0 16px #fff700, 0 0 32px #ffe066; }
}
.difficulty-btn.unlocked-final .star:last-child {
    color: #fff700;
    animation: fate-glow 1.2s infinite alternate, shake 0.5s infinite alternate;
}
@keyframes fate-glow {
    0% { filter: hue-rotate(0deg); text-shadow: 0 0 8px #fff700; }
    100% { filter: hue-rotate(360deg); text-shadow: 0 0 24px #ffe066; }
}
@keyframes shake {
    0% { transform: scale(1.18) translateX(0); }
    50% { transform: scale(1.22) translateX(-2px); }
    100% { transform: scale(1.18) translateX(2px); }
}
.difficulty-btn {
    position: relative;
    transition: transform 0.18s cubic-bezier(.4,2,.6,1), box-shadow 0.18s;
}
.difficulty-btn:focus,
.difficulty-btn:hover {
    transform: scale(1.08);
    box-shadow: 0 0 16px 4px #ffe06699, 0 0 32px 8px #fff70044;
    z-index: 2;
}
.difficulty-btn.active {
    transform: scale(1.12);
    box-shadow: 0 0 24px 8px #ffe066cc, 0 0 48px 12px #fff70066;
}
.difficulty-btn[disabled] {
    opacity: 0.6;
    pointer-events: none;
    filter: grayscale(0.7);
}

.miss-buffer-ui {
    margin: 0.5rem auto 0.5rem auto;
    padding: 0.3rem 1.2rem;
    background: rgba(255,111,145,0.12);
    color: #ff6f91;
    border-radius: 1.2rem;
    font-size: 1.1rem;
    font-weight: bold;
    box-shadow: 0 0 8px #ff6f91aa;
    text-align: center;
    min-width: 120px;
    letter-spacing: 0.1em;
    display: none;
}
.miss-buffer-ui.visible {
    display: block;
    animation: missbuffer-pop 0.5s;
}
@keyframes missbuffer-pop {
    0% { transform: scale(0.7); opacity: 0; }
    60% { transform: scale(1.15); opacity: 1; }
    100% { transform: scale(1); opacity: 1; }
}



/* 隱藏難度按鈕特殊效果 */
.hidden-difficulty {
    background: linear-gradient(135deg, #f0f, #ff6f91, #0ff, #fff700) !important;
    color: #fff !important;
    box-shadow: 0 0 30px rgba(240,0,255,0.6) !important;
    animation: hidden-glow 2s ease-in-out infinite;
}

@keyframes hidden-glow {
    0%, 100% { 
        box-shadow: 0 0 30px rgba(240,0,255,0.6);
    }
    50% { 
        box-shadow: 0 0 50px rgba(240,0,255,0.8), 0 0 70px rgba(255,111,145,0.6);
    }
}

.hidden-difficulty:hover {
    transform: scale(1.1) !important;
    box-shadow: 0 0 60px rgba(240,0,255,0.8), 0 0 100px rgba(255,111,145,0.6) !important;
}

/* 開始按鈕 */
.start-btn-container {
    display: flex;
    justify-content: center;
    width: 100%;
    margin-top: 1rem;
}

#start-btn {
    width: 150px;
    height: 150px;
    border-radius: 50%;
    border: none;
    background: linear-gradient(135deg, #0ff, #f0f, #ff6f91);
    background-size: 300% 300%;
    color: #fff;
    font-size: 1.2rem;
    font-weight: bold;
    cursor: pointer;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    box-shadow: 
        0 0 30px rgba(0,255,255,0.5),
        0 0 60px rgba(240,0,255,0.3);
    transition: all 0.3s ease;
    animation: pulse-glow 2s ease-in-out infinite;
    position: relative;
    overflow: hidden;
}

#start-btn::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
    transform: scale(0);
    transition: transform 0.5s ease;
}

#start-btn:hover::before {
    transform: scale(1);
}

#start-btn:hover {
    transform: scale(1.1);
    box-shadow: 
        0 0 50px rgba(0,255,255,0.7),
        0 0 100px rgba(240,0,255,0.5);
    animation: none;
}

#start-btn:active {
    transform: scale(0.95);
}

#start-btn:disabled {
    background: linear-gradient(135deg, #666, #444);
    color: #999;
    cursor: not-allowed;
    box-shadow: 0 0 20px rgba(102,102,102,0.3);
    animation: none;
}

/* 新增 pulse-btn 類別 */
.pulse-btn {
    animation: pulse-glow 2s ease-in-out infinite;
}

.pulse-btn.disabled {
    animation: none;
}

@keyframes pulse-glow {
    0%, 100% { 
        box-shadow: 0 0 30px rgba(0,255,255,0.5), 0 0 60px rgba(240,0,255,0.3);
    }
    50% { 
        box-shadow: 0 0 50px rgba(0,255,255,0.7), 0 0 100px rgba(240,0,255,0.5);
    }
}

.start-btn-icon {
    font-size: 2rem;
    margin-bottom: 0.5rem;
    filter: drop-shadow(0 0 10px #fff);
}

.start-btn-text {
    font-size: 1rem;
    text-shadow: 0 0 5px #fff;
}

/* 遊戲區域 */
#game-area {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    width: 100vw;
    min-height: 100vh;
    box-sizing: border-box;
}
#game-canvas {
    display: block;
    margin: 0 auto;
    box-shadow: 0 0 24px #0ff3, 0 0 4px #222a;
    background: #181a2a;
    border-radius: 18px;
    max-width: 100%;
    max-height: 100%;
    /* 移除這裡的3D變換，因為我們在JavaScript中處理 */
}

.game-header {
    position: absolute;
    top: 1.5rem;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    gap: 1.2rem;
    z-index: 10;
    width: 95%;
    max-width: 520px;
    white-space: nowrap;
}

#score-display, #timer-display {
    font-size: 2.2rem;
    color: #222;
    background: rgba(255,255,255,0.45);
    border-radius: 18px;
    padding: 0.5rem 2.2rem;
    box-shadow: 0 2px 16px 0 rgba(0,0,0,0.08);
    font-family: 'Orbitron', 'Audiowide', Arial, sans-serif;
    font-weight: bold;
    letter-spacing: 2px;
    backdrop-filter: blur(6px);
    border: 1.5px solid rgba(255,255,255,0.25);
    text-shadow: 0 2px 8px #fff, 0 0 2px #0ff;
}

/* 倒數危險紅色樣式 */
#timer-display.timer-danger {
    color: #fff;
    background: #ff3b3b;
    border: 2px solid #ff3b3b;
    text-shadow: 0 0 16px #ff3b3b, 0 0 8px #fff;
    animation: timer-danger-blink 0.5s alternate infinite;
}

@keyframes timer-danger-blink {
    0% { filter: brightness(1.2); }
    100% { filter: brightness(0.7); }
}

#combo-display {
    position: absolute;
    top: 2.5cm;
    left: 50%;
    transform: translateX(-50%);
    font-size: 3.5rem;
    color: #FFFFFF;
    font-weight: bold;
    text-shadow:
        0 0 8px #BA55D3,
        0 0 16px #00FFFF,
        2px 2px 0 #BA55D3,
        -2px -2px 0 #00FFFF;
    -webkit-text-stroke: 2px #00FFFF;
    letter-spacing: 2px;
    z-index: 20;
    transition: transform 0.18s cubic-bezier(0.22, 1, 0.36, 1);
    pointer-events: none;
}
#combo-display.combo-pulse {
    animation: combo-scale-bounce 0.28s cubic-bezier(0.22, 1, 0.36, 1);
}
@keyframes combo-scale-bounce {
    0% { transform: translateX(-50%) scale(1); }
    40% { transform: translateX(-50%) scale(1.12); }
    60% { transform: translateX(-50%) scale(1.08); }
    100% { transform: translateX(-50%) scale(1); }
}
#combo-display.glow {
    text-shadow:
        0 0 16px #fff,
        0 0 32px #BA55D3,
        0 0 48px #00FFFF,
        2px 2px 0 #BA55D3,
        -2px -2px 0 #00FFFF;
    filter: brightness(1.2) drop-shadow(0 0 8px #fff700);
    animation: combo-glow-shake 0.4s infinite alternate;
}
@keyframes combo-glow-shake {
    0% { transform: translateX(-50%) scale(1) rotate(-1deg); }
    50% { transform: translateX(-50%) scale(1.04) rotate(1deg); }
    100% { transform: translateX(-50%) scale(1) rotate(-1deg); }
}

/* 3D透視賽道邊線 */
#game-canvas::after {
    content: '';
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    background: 
        /* 左邊線 - 強化3D透視效果 */
        linear-gradient(90deg,
            transparent 15%,
            rgba(255, 255, 255, 0.3) 18%,
            rgba(255, 255, 255, 0.5) 19%,
            rgba(255, 255, 255, 0.7) 19.5%,
            rgba(255, 255, 255, 0.8) 20%,
            rgba(255, 255, 255, 0.85) 22%,
            rgba(255, 255, 255, 0.9) 25%,
            rgba(255, 255, 255, 0.95) 30%,
            rgba(255, 255, 255, 1) 35%,
            rgba(255, 255, 255, 1) 40%,
            rgba(255, 255, 255, 1) 45%,
            rgba(255, 255, 255, 0.95) 50%,
            rgba(255, 255, 255, 0.9) 55%,
            rgba(255, 255, 255, 0.8) 60%,
            transparent 65%
        ),
        /* 右邊線 - 強化3D透視效果 */
        linear-gradient(90deg,
            transparent 35%,
            rgba(255, 255, 255, 0.8) 40%,
            rgba(255, 255, 255, 0.9) 45%,
            rgba(255, 255, 255, 0.95) 50%,
            rgba(255, 255, 255, 1) 55%,
            rgba(255, 255, 255, 1) 60%,
            rgba(255, 255, 255, 1) 65%,
            rgba(255, 255, 255, 0.95) 70%,
            rgba(255, 255, 255, 0.9) 75%,
            rgba(255, 255, 255, 0.85) 78%,
            rgba(255, 255, 255, 0.8) 80%,
            rgba(255, 255, 255, 0.7) 80.5%,
            rgba(255, 255, 255, 0.5) 81%,
            rgba(255, 255, 255, 0.3) 82%,
            transparent 85%
        );
    background-size: 100% 100%;
    pointer-events: none;
    z-index: 3;
    transform: perspective(300px) rotateX(30deg);
    transform-origin: center bottom;
}

/* 擊中特效增強 */
#game-canvas::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border-radius: 15px;
    background: radial-gradient(circle at 50% 50%, transparent 0%, rgba(250, 250, 210, 0.05) 50%, transparent 100%);
    opacity: 0;
    pointer-events: none;
    z-index: 1;
    transition: opacity 0.1s ease;
}

#game-canvas.hit-flash::after {
    opacity: 1;
    animation: hit-flash 0.2s ease-out;
}

@keyframes hit-flash {
    0% { opacity: 0; }
    50% { opacity: 1; }
    100% { opacity: 0; }
}

/* Fever模式視覺增強 */
.fever-mode #game-canvas {
    animation: fever-pulse 0.5s ease-in-out infinite;
}

.fever-mode #combo-display {
    animation: fever-glow 0.3s ease-in-out infinite;
}

.fever-mode .key {
    animation: fever-key-pulse 0.4s ease-in-out infinite;
}

@keyframes fever-pulse {
    0%, 100% { 
        box-shadow: 
            0 0 30px rgba(0,255,255,0.5),
            0 0 60px rgba(138, 43, 226, 0.3),
            inset 0 0 20px rgba(108, 45, 199, 0.1);
    }
    50% { 
        box-shadow: 
            0 0 50px rgba(0,255,255,0.8),
            0 0 100px rgba(138, 43, 226, 0.6),
            inset 0 0 30px rgba(108, 45, 199, 0.2);
    }
}

@keyframes fever-glow {
    0%, 100% { 
        text-shadow: 0 0 30px #fff700;
        transform: scale(1);
    }
    50% { 
        text-shadow: 0 0 50px #fff700, 0 0 80px #FFD700;
        transform: scale(1.1);
    }
}

@keyframes fever-key-pulse {
    0%, 100% { 
        box-shadow: 
            0 0 15px rgba(0,255,255,0.3),
            0 0 30px rgba(138, 43, 226, 0.2);
    }
    50% { 
        box-shadow: 
            0 0 25px rgba(0,255,255,0.6),
            0 0 50px rgba(138, 43, 226, 0.4);
    }
}

@keyframes canvas-border-glow {
    0%, 100% { 
        opacity: 0.3;
        transform: scale(1);
    }
    50% { 
        opacity: 0.6;
        transform: scale(1.01);
    }
}

/* 軌道高亮效果增強 */
.lane-highlight-perfect {
    animation: lane-perfect-glow 0.3s ease-out;
}

.lane-highlight-great {
    animation: lane-great-glow 0.3s ease-out;
}

.lane-highlight-good {
    animation: lane-good-glow 0.3s ease-out;
}

@keyframes lane-perfect-glow {
    0% { 
        filter: brightness(1) drop-shadow(0 0 20px rgba(255,255,255,0.8));
    }
    50% { 
        filter: brightness(1.5) drop-shadow(0 0 40px rgba(255,255,255,1));
    }
    100% { 
        filter: brightness(1) drop-shadow(0 0 20px rgba(255,255,255,0.8));
    }
}

@keyframes lane-great-glow {
    0% { 
        filter: brightness(1) drop-shadow(0 0 15px rgba(255,255,255,0.6));
    }
    50% { 
        filter: brightness(1.3) drop-shadow(0 0 30px rgba(255,255,255,0.8));
    }
    100% { 
        filter: brightness(1) drop-shadow(0 0 15px rgba(255,255,255,0.6));
    }
}

@keyframes lane-good-glow {
    0% { 
        filter: brightness(1) drop-shadow(0 0 10px rgba(255,255,255,0.5));
    }
    50% { 
        filter: brightness(1.2) drop-shadow(0 0 20px rgba(255,255,255,0.7));
    }
    100% { 
        filter: brightness(1) drop-shadow(0 0 10px rgba(255,255,255,0.5));
    }
}

/* 音頻可視化 */
#audio-visualizer {
    position: absolute;
    bottom: 2rem;
    left: 50%;
    transform: translateX(-50%);
    width: 80%;
    height: 60px;
    border-radius: 10px;
    background: rgba(0,0,0,0.5);
    border: 1px solid #0ff;
    box-shadow: 0 0 20px rgba(0,255,255,0.3);
}

/* 按鍵提示 */
#key-hints {
    position: absolute;
    bottom: 1rem;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 1rem;
    z-index: 10;
}

.key {
    width: 60px;
    height: 60px;
    background: linear-gradient(135deg, #1C1C80, #0D0E52);
    border: 2px solid #0ff;
    border-radius: 10px;
    color: #0ff;
    font-size: 1.2rem;
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 0 8px #0ff;
    border: 1.5px solid #0ff;
    transition: all 0.1s ease;
    text-shadow: 0 0 5px #0ff;
    position: relative;
}

.key::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(45deg, transparent, rgba(138, 43, 226, 0.1), transparent);
    border-radius: 10px;
    opacity: 0;
    transition: opacity 0.2s ease;
}

.key:hover::before {
    opacity: 1;
}

.key.active, .key:active {
    background: linear-gradient(135deg, #ff00ff, #ff6f91);
    border-color: #fff;
    color: #fff;
    box-shadow: 
        0 0 30px rgba(255,0,255,0.8),
        0 0 60px rgba(255,111,145,0.6),
        inset 0 0 20px rgba(255,255,255,0.3);
    transform: scale(0.9);
    animation: key-press 0.1s ease-out;
    text-shadow: 0 0 10px #fff;
}

/* 按鍵判定等級高亮效果 */
.key.perfect-hit {
    animation: key-perfect-hit 0.3s ease-out;
}

.key.great-hit {
    animation: key-great-hit 0.3s ease-out;
}

.key.good-hit {
    animation: key-good-hit 0.3s ease-out;
}

@keyframes key-perfect-hit {
    0% { 
        background: linear-gradient(135deg, #ffffff, #f0f0f0);
        border-color: #fff;
        color: #000;
        box-shadow: 
            0 0 40px rgba(255,255,255,1),
            0 0 80px rgba(255,255,255,0.8);
        transform: scale(1.1);
    }
    50% { 
        background: linear-gradient(135deg, #ffffff, #f0f0f0);
        border-color: #fff;
        color: #000;
        box-shadow: 
            0 0 60px rgba(255,255,255,1),
            0 0 120px rgba(255,255,255,0.9);
        transform: scale(1.2);
    }
    100% { 
        background: linear-gradient(135deg, #1C1C80, #0D0E52);
        border-color: #0ff;
        color: #0ff;
        box-shadow: 0 0 8px #0ff;
        transform: scale(1);
    }
}

@keyframes key-great-hit {
    0% { 
        background: linear-gradient(135deg, #ffffff, #f0f0f0);
        border-color: #fff;
        color: #000;
        box-shadow: 
            0 0 30px rgba(255,255,255,0.8),
            0 0 60px rgba(255,255,255,0.6);
        transform: scale(1.05);
    }
    50% { 
        background: linear-gradient(135deg, #ffffff, #f0f0f0);
        border-color: #fff;
        color: #000;
        box-shadow: 
            0 0 45px rgba(255,255,255,0.9),
            0 0 90px rgba(255,255,255,0.7);
        transform: scale(1.1);
    }
    100% { 
        background: linear-gradient(135deg, #1C1C80, #0D0E52);
        border-color: #0ff;
        color: #0ff;
        box-shadow: 0 0 8px #0ff;
        transform: scale(1);
    }
}

@keyframes key-good-hit {
    0% { 
        background: linear-gradient(135deg, #ffffff, #f0f0f0);
        border-color: #fff;
        color: #000;
        box-shadow: 
            0 0 20px rgba(255,255,255,0.6),
            0 0 40px rgba(255,255,255,0.4);
        transform: scale(1.02);
    }
    50% { 
        background: linear-gradient(135deg, #ffffff, #f0f0f0);
        border-color: #fff;
        color: #000;
        box-shadow: 
            0 0 30px rgba(255,255,255,0.7),
            0 0 60px rgba(255,255,255,0.5);
        transform: scale(1.05);
    }
    100% { 
        background: linear-gradient(135deg, #1C1C80, #0D0E52);
        border-color: #0ff;
        color: #0ff;
        box-shadow: 0 0 8px #0ff;
        transform: scale(1);
    }
}

@keyframes key-press {
    0% { 
        transform: scale(1);
        box-shadow: 0 0 8px #0ff;
    }
    50% { 
        transform: scale(0.85);
        box-shadow: 
            0 0 40px rgba(255,0,255,0.9),
            0 0 80px rgba(255,111,145,0.7);
    }
    100% { 
        transform: scale(0.9);
        box-shadow: 
            0 0 30px rgba(255,0,255,0.8),
            0 0 60px rgba(255,111,145,0.6);
    }
}

/* Combo 容器 */
#combo-container {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    z-index: 20;
    pointer-events: none;
    display: flex;
    align-items: center;
    justify-content: center;
    filter: drop-shadow(0 0 10px #fff700) drop-shadow(0 0 6px #0ff);
}

.combo-effect {
    position: absolute;
    font-size: 8rem;
    color: #fff700;
    text-shadow: 
        0 0 40px #fff700,
        0 0 80px rgba(138, 43, 226, 0.8),
        0 0 120px rgba(108, 45, 199, 0.6);
    pointer-events: none;
    user-select: none;
    z-index: 21;
    animation: combo-effect-flash 0.3s, combo-shake 0.3s;
    filter: drop-shadow(0 0 20px rgba(138, 43, 226, 0.5));
}

/* Combo破百後的強化特效 */
.combo-effect[data-combo="100"],
.combo-effect[data-combo="150"],
.combo-effect[data-combo="200"] {
    animation: combo-effect-flash 0.4s, combo-shake 0.4s, combo-golden-glow 0.4s;
    text-shadow: 
        0 0 50px #fff700,
        0 0 100px rgba(250, 250, 210, 0.9),
        0 0 150px rgba(248, 248, 255, 0.8),
        0 0 200px rgba(138, 43, 226, 0.6);
}

@keyframes combo-golden-glow {
    0% { 
        filter: drop-shadow(0 0 20px rgba(250, 250, 210, 0.5));
        transform: scale(1);
    }
    50% { 
        filter: drop-shadow(0 0 40px rgba(250, 250, 210, 0.8));
        transform: scale(1.1);
    }
    100% { 
        filter: drop-shadow(0 0 20px rgba(250, 250, 210, 0.5));
        transform: scale(1);
    }
}
@keyframes combo-shake {
    0% { transform: translateX(0); }
    25% { transform: translateX(-8px); }
    50% { transform: translateX(8px); }
    75% { transform: translateX(-4px); }
    100% { transform: translateX(0); }
}

.miss-effect {
    animation: miss-flash 0.3s, miss-shake 0.3s;
}
@keyframes miss-flash {
    0% { background: #ff6f91; opacity: 1; }
    100% { background: transparent; opacity: 0; }
}
@keyframes miss-shake {
    0% { transform: translateY(0); }
    25% { transform: translateY(-8px); }
    50% { transform: translateY(8px); }
    75% { transform: translateY(-4px); }
    100% { transform: translateY(0); }
}

@keyframes combo-effect-flash {
    0% { opacity: 0; transform: scale(0.5); }
    50% { opacity: 1; transform: scale(1.2); }
    100% { opacity: 0; transform: scale(1); }
}

/* 結算畫面 */
#result-screen {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 100%;
    max-width: 600px;
    padding: 0.5rem 0.2rem;
    margin: 2rem auto 0 auto;
    background: linear-gradient(135deg, rgba(24,24,40,0.9) 0%, rgba(34,34,68,0.95) 100%);
    border-radius: 24px;
    box-shadow: 0 4px 32px 0 rgba(0,0,0,0.10);
    backdrop-filter: blur(8px);
    border: 1.5px solid rgba(255,255,255,0.18);
    position: relative;
    top: unset;
    left: unset;
    transform: none;
    z-index: 10;
}

.result-title {
    font-size: 1.2rem; /* 若有需要可調小 */
    color: #0ff;
    text-shadow: 0 0 25px #0ff;
    margin-bottom: 0.5rem; /* 原本可能較大，調小 */
    text-align: center;
}

.result-content {
    max-width: 500px;
    margin: 0 auto;
    padding: 32px 24px;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

.final-score {
    font-size: 3.5rem !important; /* 與 #combo-display 一致 */
    color: #4ecdc4 !important;
    text-shadow: 0 0 15px #4ecdc4 !important;
}
@media (max-width: 768px) {
    .final-score {
        font-size: 2rem !important;
    }
}
@media (max-width: 480px) {
    .final-score {
        font-size: 1.5rem !important;
    }
}

.final-grade {
    font-size: 1.2rem;
    color: #ffb347;
    text-shadow: 0 0 20px #ffb347;
    font-weight: bold;
}

.result-buttons {
    display: flex;
    gap: 0.3rem; /* 若有 gap，調小 */
    flex-wrap: wrap;
    justify-content: center;
    margin-top: 0.3rem; /* 若有 margin-top，調小 */
}

.action-btn {
    background: linear-gradient(90deg, #0ff 0%, #fff700 100%);
    color: #222;
    border-radius: 12px;
    border: none;
    font-family: 'Orbitron', 'Audiowide', Arial, sans-serif;
    font-weight: bold;
    font-size: 0.9rem; /* 若有需要可調小 */
    box-shadow: 0 2px 12px 0 rgba(0,0,0,0.08);
    padding: 0.5rem 1rem; /* 原本可能較大，調小 */
    margin: 0.3rem;
    transition: background 0.2s, color 0.2s, box-shadow 0.2s;
}

.action-btn:hover {
    background: linear-gradient(90deg, #fff700 0%, #0ff 100%);
    color: #000;
    box-shadow: 0 4px 24px 0 rgba(0,255,255,0.18);
}

.btn-icon {
    font-size: 1.5rem;
    filter: drop-shadow(0 0 5px #fff);
}

/* 響應式設計 */
@media (max-width: 768px) {
    .neon-logo {
        font-size: 2.5rem;
    }
    
    .subtitle {
        font-size: 1.1rem;
    }
    
    .song-card {
        min-width: 160px;
        height: 180px;
        padding: 1rem;
    }
    
    .song-card-icon {
        font-size: 2rem;
    }
    
    .song-card-title {
        font-size: 0.9rem;
    }
    
    .difficulty-btn {
        width: 100px;
        height: 100px;
    }
    
    .difficulty-name {
        font-size: 0.7rem;
    }
    
    .difficulty-desc {
        font-size: 0.6rem;
    }
    
    #start-btn {
        width: 120px;
        height: 120px;
    }
    
    .start-btn-icon {
        font-size: 1.5rem;
    }
    
    .start-btn-text {
        font-size: 0.9rem;
    }
    
    #combo-display {
        font-size: 2rem;
    }
    
    .combo-effect {
        font-size: 4rem;
    }
    
    .key {
        width: 50px;
        height: 50px;
        font-size: 1rem;
    }
    .song-card-list {
        flex-wrap: nowrap;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        gap: 0.5rem;
    }
    .song-card {
        min-width: 180px;
        max-width: 220px;
        font-size: 0.95rem;
    }
    .difficulty-btn-row {
        flex-wrap: wrap;
        gap: 0.5rem;
    }
    #main-wrapper {
        padding: 0.2rem 0;
    }
    #game-area {
        max-width: 100vw;
        min-width: 0;
        padding: 0.2rem;
    }
    #game-canvas {
        width: 100vw !important;
        max-width: 100vw !important;
        height: 40vw !important;
        min-height: 200px;
        max-height: 60vw;
    }
    #result-screen {
        padding: 0.2rem 0.1rem;
        font-size: 1rem;
    }
    .result-title {
        font-size: 1rem;
    }
    .final-score, .final-grade {
        font-size: 0.8rem;
    }
}

@media (max-width: 480px) {
    .neon-logo {
        font-size: 2rem;
    }
    
    .song-card-list {
        gap: 1rem;
    }
    
    .song-card {
        min-width: 140px;
        height: 160px;
    }
    
    .difficulty-btn-row {
        gap: 0.5rem;
    }
    
    .difficulty-btn {
        width: 80px;
        height: 80px;
    }
    
    .difficulty-icon {
        font-size: 1.2rem;
    }
    
    .difficulty-name {
        font-size: 0.6rem;
    }
    
    .difficulty-desc {
        font-size: 0.5rem;
    }
    
    #start-btn {
        width: 100px;
        height: 100px;
    }
    
    .start-btn-icon {
        font-size: 1.2rem;
    }
    
    .start-btn-text {
        font-size: 0.8rem;
    }
    
    .result-title {
        font-size: 1.5rem;
    }
    
    .final-score {
        font-size: 1.2rem;
    }
    
    .final-grade {
        font-size: 1.5rem;
    }
    
    .action-btn {
        padding: 0.3rem 0.7rem;
        font-size: 0.7rem;
    }
}

/* 動畫效果 */
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

@keyframes slideInLeft {
    from { opacity: 0; transform: translateX(-50px); }
    to { opacity: 1; transform: translateX(0); }
}

@keyframes slideInRight {
    from { opacity: 0; transform: translateX(50px); }
    to { opacity: 1; transform: translateX(0); }
}

/* 全域動畫類別 */
.fade-in {
    animation: fadeIn 0.5s ease-out;
}

.slide-in-left {
    animation: slideInLeft 0.5s ease-out;
}

.slide-in-right {
    animation: slideInRight 0.5s ease-out;
} 

/* ====== 新現代科技感風格 ====== */

body {
    background: linear-gradient(135deg, #0a0a1a 0%, #1C1C80 100%);
    min-height: 100vh;
    font-family: 'Orbitron', 'Audiowide', '微軟正黑體', Arial, sans-serif;
    color: #fff;
}

#main-wrapper {
    background: linear-gradient(135deg, rgba(24,26,42,0.55) 0%, rgba(35,35,90,0.55) 100%) !important;
    background-blend-mode: lighten;
    border-radius: 30px;
    box-shadow: 0 8px 40px 0 rgba(0,0,0,0.18);
    padding: 1rem 0;
}

/* 移除主畫面內容層級調整，回到原本設定 */
#main-content, .main-content, .menu, .menu-area, .main-menu {
  position: static;
  z-index: auto;
}

#game-area {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  z-index: 1000;
  background: transparent;
  display: none; /* 預設隱藏，遊戲時才顯示 */
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

#game-area.active {
  display: flex;
}

#game-canvas {
    width: 100vw !important;
    height: 100vh !important;
    max-width: 100vw;
    max-height: 100vh;
    display: block;
    background: 
        /* 3D透視賽道背景 - 超極端收縮效果 */
        linear-gradient(90deg, 
            transparent 0%, 
            rgba(0, 100, 150, 0.05) 20%, 
            rgba(0, 100, 150, 0.1) 22%, 
            rgba(0, 100, 150, 0.2) 24%, 
            rgba(0, 100, 150, 0.3) 25%, 
            rgba(0, 100, 150, 0.4) 26%, 
            rgba(0, 100, 150, 0.5) 28%, 
            rgba(0, 100, 150, 0.6) 30%, 
            rgba(0, 100, 150, 0.7) 35%, 
            rgba(0, 100, 150, 0.8) 40%, 
            rgba(0, 100, 150, 0.9) 45%, 
            rgba(0, 100, 150, 1) 50%, 
            rgba(0, 100, 150, 1) 55%, 
            rgba(0, 100, 150, 1) 60%, 
            rgba(0, 100, 150, 1) 65%, 
            rgba(0, 100, 150, 1) 70%, 
            rgba(0, 100, 150, 0.9) 75%, 
            rgba(0, 100, 150, 0.8) 80%, 
            rgba(0, 100, 150, 0.3) 80.5%, 
            rgba(0, 100, 150, 0.1) 81%, 
            transparent 100%
        ),
        /* 賽道深度漸變 - 超極端透視 */
        linear-gradient(180deg,
            rgba(0, 0, 0, 0.98) 0%,
            rgba(0, 0, 0, 0.95) 5%,
            rgba(0, 0, 0, 0.9) 10%,
            rgba(0, 0, 0, 0.8) 15%,
            rgba(0, 0, 0, 0.7) 20%,
            rgba(0, 0, 0, 0.6) 25%,
            rgba(0, 0, 0, 0.5) 30%,
            rgba(0, 0, 0, 0.4) 35%,
            rgba(0, 0, 0, 0.3) 40%,
            rgba(0, 0, 0, 0.2) 45%,
            rgba(0, 0, 0, 0.1) 50%,
            rgba(0, 0, 0, 0.05) 55%,
            rgba(0, 0, 0, 0.02) 60%,
            rgba(0, 0, 0, 0.01) 100%
        ),
        /* 賽道跑道線條 - 超極端收縮 */
        repeating-linear-gradient(90deg,
            transparent 0%,
            transparent 24%,
            rgba(0, 255, 255, 0.1) 24.5%,
            rgba(0, 255, 255, 0.2) 25%,
            rgba(0, 255, 255, 0.3) 26%,
            rgba(0, 255, 255, 0.4) 27%,
            rgba(0, 255, 255, 0.5) 28%,
            rgba(0, 255, 255, 0.6) 29%,
            rgba(0, 255, 255, 0.7) 30%,
            rgba(0, 255, 255, 0.8) 35%,
            rgba(0, 255, 255, 0.9) 40%,
            rgba(0, 255, 255, 1) 45%,
            rgba(0, 255, 255, 1) 50%,
            rgba(0, 255, 255, 1) 55%,
            rgba(0, 255, 255, 0.9) 60%,
            rgba(0, 255, 255, 0.8) 65%,
            rgba(0, 255, 255, 0.7) 70%,
            rgba(0, 255, 255, 0.6) 71%,
            rgba(0, 255, 255, 0.5) 72%,
            rgba(0, 255, 255, 0.4) 73%,
            rgba(0, 255, 255, 0.3) 74%,
            rgba(0, 255, 255, 0.2) 75%,
            rgba(0, 255, 255, 0.1) 75.5%,
            transparent 76%
        ),
        /* 賽道跑道線條 - 第二條 */
        repeating-linear-gradient(90deg,
            transparent 0%,
            transparent 48%,
            rgba(0, 255, 255, 0.1) 48.5%,
            rgba(0, 255, 255, 0.2) 49%,
            rgba(0, 255, 255, 0.3) 50%,
            rgba(0, 255, 255, 0.4) 51%,
            rgba(0, 255, 255, 0.5) 52%,
            rgba(0, 255, 255, 0.6) 53%,
            rgba(0, 255, 255, 0.7) 54%,
            rgba(0, 255, 255, 0.8) 55%,
            rgba(0, 255, 255, 0.9) 60%,
            rgba(0, 255, 255, 1) 65%,
            rgba(0, 255, 255, 1) 70%,
            rgba(0, 255, 255, 0.9) 75%,
            rgba(0, 255, 255, 0.8) 76%,
            rgba(0, 255, 255, 0.7) 77%,
            rgba(0, 255, 255, 0.6) 78%,
            rgba(0, 255, 255, 0.5) 79%,
            rgba(0, 255, 255, 0.4) 80%,
            rgba(0, 255, 255, 0.3) 81%,
            rgba(0, 255, 255, 0.2) 82%,
            rgba(0, 255, 255, 0.1) 82.5%,
            transparent 83%
        ),
        /* 賽道跑道線條 - 第三條 */
        repeating-linear-gradient(90deg,
            transparent 0%,
            transparent 72%,
            rgba(0, 255, 255, 0.1) 72.5%,
            rgba(0, 255, 255, 0.2) 73%,
            rgba(0, 255, 255, 0.3) 74%,
            rgba(0, 255, 255, 0.4) 75%,
            rgba(0, 255, 255, 0.5) 76%,
            rgba(0, 255, 255, 0.6) 77%,
            rgba(0, 255, 255, 0.7) 78%,
            rgba(0, 255, 255, 0.8) 79%,
            rgba(0, 255, 255, 0.9) 80%,
            rgba(0, 255, 255, 1) 85%,
            rgba(0, 255, 255, 0.9) 86%,
            rgba(0, 255, 255, 0.8) 87%,
            rgba(0, 255, 255, 0.7) 88%,
            rgba(0, 255, 255, 0.6) 89%,
            rgba(0, 255, 255, 0.5) 90%,
            rgba(0, 255, 255, 0.4) 91%,
            rgba(0, 255, 255, 0.3) 92%,
            rgba(0, 255, 255, 0.2) 93%,
            rgba(0, 255, 255, 0.1) 93.5%,
            transparent 94%
        );
    border-radius: 0 0 40px 40px;
    box-shadow: 
        0 0 40px 0 rgba(0,100,150,0.2),
        inset 0 0 150px rgba(0,100,150,0.1);
    border: none;
    clip-path: polygon(25% 0, 75% 0, 100% 100%, 0 100%);
    position: relative;
    z-index: 2;
    /* 移除CSS的3D變換，因為我們在JavaScript中處理，確保縮放一致 */
    /* transform: perspective(800px) rotateX(8deg); */
    /* transform-origin: center bottom; */
}

.game-header {
    position: absolute;
    top: 1.5rem;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    gap: 1.2rem;
    z-index: 10;
    width: 95%;
    max-width: 520px;
    white-space: nowrap;
}

#score-display, #timer-display {
    font-size: 2.2rem;
    color: #222;
    background: rgba(255,255,255,0.45);
    border-radius: 18px;
    padding: 0.5rem 2.2rem;
    box-shadow: 0 2px 16px 0 rgba(0,0,0,0.08);
    font-family: 'Orbitron', 'Audiowide', Arial, sans-serif;
    font-weight: bold;
    letter-spacing: 2px;
    backdrop-filter: blur(6px);
    border: 1.5px solid rgba(255,255,255,0.25);
    text-shadow: 0 2px 8px #fff, 0 0 2px #0ff;
}

/* 倒數危險紅色樣式 */
#timer-display.timer-danger {
    color: #fff;
    background: #ff3b3b;
    border: 2px solid #ff3b3b;
    text-shadow: 0 0 16px #ff3b3b, 0 0 8px #fff;
    animation: timer-danger-blink 0.5s alternate infinite;
}

@keyframes timer-danger-blink {
    0% { filter: brightness(1.2); }
    100% { filter: brightness(0.7); }
}

#combo-display {
    font-size: 4rem;
    color: #fff700;
    text-shadow: 0 0 30px #fff700, 0 0 10px #fff, 0 0 2px #0ff;
    font-family: 'Orbitron', 'Audiowide', Arial, sans-serif;
    font-weight: bold;
    letter-spacing: 2px;
    background: rgba(255,255,255,0.18);
    border-radius: 16px;
    padding: 0.2rem 1.2rem;
    box-shadow: 0 2px 12px 0 rgba(0,0,0,0.08);
    border: 1.5px solid rgba(255,255,255,0.18);
    backdrop-filter: blur(4px);
}

/* 3D透視賽道邊線 - 第二個定義 */
#game-canvas::after {
    content: '';
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    background: 
        /* 左邊線 - 強化3D透視效果 */
        linear-gradient(90deg,
            transparent 15%,
            rgba(255, 255, 255, 0.3) 18%,
            rgba(255, 255, 255, 0.5) 19%,
            rgba(255, 255, 255, 0.7) 19.5%,
            rgba(255, 255, 255, 0.8) 20%,
            rgba(255, 255, 255, 0.85) 22%,
            rgba(255, 255, 255, 0.9) 25%,
            rgba(255, 255, 255, 0.95) 30%,
            rgba(255, 255, 255, 1) 35%,
            rgba(255, 255, 255, 1) 40%,
            rgba(255, 255, 255, 1) 45%,
            rgba(255, 255, 255, 0.95) 50%,
            rgba(255, 255, 255, 0.9) 55%,
            rgba(255, 255, 255, 0.8) 60%,
            transparent 65%
        ),
        /* 右邊線 - 強化3D透視效果 */
        linear-gradient(90deg,
            transparent 35%,
            rgba(255, 255, 255, 0.8) 40%,
            rgba(255, 255, 255, 0.9) 45%,
            rgba(255, 255, 255, 0.95) 50%,
            rgba(255, 255, 255, 1) 55%,
            rgba(255, 255, 255, 1) 60%,
            rgba(255, 255, 255, 1) 65%,
            rgba(255, 255, 255, 0.95) 70%,
            rgba(255, 255, 255, 0.9) 75%,
            rgba(255, 255, 255, 0.85) 78%,
            rgba(255, 255, 255, 0.8) 80%,
            rgba(255, 255, 255, 0.7) 80.5%,
            rgba(255, 255, 255, 0.5) 81%,
            rgba(255, 255, 255, 0.3) 82%,
            transparent 85%
        );
    background-size: 100% 100%;
    pointer-events: none;
    z-index: 3;
    transform: perspective(300px) rotateX(30deg);
    transform-origin: center bottom;
}

/* MISS/CHAIN 樣式 */
.miss-label, .chain-label {
    font-size: 2.5rem !important;
    font-family: 'Orbitron', 'Audiowide', Arial, sans-serif;
    color: #ff6f91 !important;
    text-shadow: 0 0 12px #fff, 0 0 8px #ff6f91;
    opacity: 0.95;
    letter-spacing: 2px;
    font-weight: bold;
}
.chain-label {
    color: #00CFFF !important;
    text-shadow: 0 0 12px #fff, 0 0 8px #00CFFF;
}

/* 分數區塊玻璃感 */
#score-display, #timer-display {
    background: rgba(255,255,255,0.45);
    backdrop-filter: blur(6px);
    border: 1.5px solid rgba(255,255,255,0.25);
}

/* 星空背景 - 左右兩側 */
#game-area {
    background: 
        /* 左側星空背景 - 更多星星，更自然的分佈 */
        radial-gradient(circle at 8% 15%, rgba(255, 255, 255, 0.9) 1px, transparent 1px),
        radial-gradient(circle at 18% 35%, rgba(255, 255, 255, 0.7) 1px, transparent 1px),
        radial-gradient(circle at 28% 55%, rgba(255, 255, 255, 0.8) 1px, transparent 1px),
        radial-gradient(circle at 38% 75%, rgba(255, 255, 255, 0.6) 1px, transparent 1px),
        radial-gradient(circle at 12% 25%, rgba(255, 255, 255, 0.5) 1px, transparent 1px),
        radial-gradient(circle at 22% 45%, rgba(255, 255, 255, 0.8) 1px, transparent 1px),
        radial-gradient(circle at 32% 65%, rgba(255, 255, 255, 0.7) 1px, transparent 1px),
        radial-gradient(circle at 42% 85%, rgba(255, 255, 255, 0.9) 1px, transparent 1px),
        radial-gradient(circle at 5% 40%, rgba(255, 255, 255, 0.6) 1px, transparent 1px),
        radial-gradient(circle at 15% 60%, rgba(255, 255, 255, 0.8) 1px, transparent 1px),
        radial-gradient(circle at 25% 80%, rgba(255, 255, 255, 0.7) 1px, transparent 1px),
        radial-gradient(circle at 35% 95%, rgba(255, 255, 255, 0.5) 1px, transparent 1px),
        
        /* 右側星空背景 - 對稱分佈 */
        radial-gradient(circle at 92% 15%, rgba(255, 255, 255, 0.9) 1px, transparent 1px),
        radial-gradient(circle at 82% 35%, rgba(255, 255, 255, 0.7) 1px, transparent 1px),
        radial-gradient(circle at 72% 55%, rgba(255, 255, 255, 0.8) 1px, transparent 1px),
        radial-gradient(circle at 62% 75%, rgba(255, 255, 255, 0.6) 1px, transparent 1px),
        radial-gradient(circle at 88% 25%, rgba(255, 255, 255, 0.5) 1px, transparent 1px),
        radial-gradient(circle at 78% 45%, rgba(255, 255, 255, 0.8) 1px, transparent 1px),
        radial-gradient(circle at 68% 65%, rgba(255, 255, 255, 0.7) 1px, transparent 1px),
        radial-gradient(circle at 58% 85%, rgba(255, 255, 255, 0.9) 1px, transparent 1px),
        radial-gradient(circle at 95% 40%, rgba(255, 255, 255, 0.6) 1px, transparent 1px),
        radial-gradient(circle at 85% 60%, rgba(255, 255, 255, 0.8) 1px, transparent 1px),
        radial-gradient(circle at 75% 80%, rgba(255, 255, 255, 0.7) 1px, transparent 1px),
        radial-gradient(circle at 65% 95%, rgba(255, 255, 255, 0.5) 1px, transparent 1px),
        
        /* 深藍色星空背景 - 更豐富的漸變 */
        linear-gradient(135deg, #0a0a1a 0%, #1a1a3a 20%, #2a2a5a 40%, #3a3a7a 60%, #2a2a5a 80%, #1a1a3a 100%);
    background-size: 
        120px 120px, 100px 100px, 140px 140px, 80px 80px, 160px 160px, 90px 90px, 110px 110px, 130px 130px, 150px 150px, 70px 70px, 180px 180px, 95px 95px,
        120px 120px, 100px 100px, 140px 140px, 80px 80px, 160px 160px, 90px 90px, 110px 110px, 130px 130px, 150px 150px, 70px 70px, 180px 180px, 95px 95px,
        100% 100%;
    background-position: 
        0 0, 30px 60px, 60px 120px, 90px 180px, 120px 240px, 150px 300px, 180px 360px, 210px 420px, 240px 480px, 270px 540px, 300px 600px, 330px 660px,
        0 0, 30px 60px, 60px 120px, 90px 180px, 120px 240px, 150px 300px, 180px 360px, 210px 420px, 240px 480px, 270px 540px, 300px 600px, 330px 660px,
        0 0;
    animation: starry-night 25s linear infinite;
}

/* 星空動畫效果 */
@keyframes starry-night {
    0% {
        background-position: 
            0 0, 30px 60px, 60px 120px, 90px 180px, 120px 240px, 150px 300px, 180px 360px, 210px 420px, 240px 480px, 270px 540px, 300px 600px, 330px 660px,
            0 0, 30px 60px, 60px 120px, 90px 180px, 120px 240px, 150px 300px, 180px 360px, 210px 420px, 240px 480px, 270px 540px, 300px 600px, 330px 660px,
            0 0;
    }
    100% {
        background-position: 
            0 -120px, 30px -60px, 60px 0px, 90px 60px, 120px 120px, 150px 180px, 180px 240px, 210px 300px, 240px 360px, 270px 420px, 300px 480px, 330px 540px,
            0 -120px, 30px -60px, 60px 0px, 90px 60px, 120px 120px, 150px 180px, 180px 240px, 210px 300px, 240px 360px, 270px 420px, 300px 480px, 330px 540px,
            0 0;
    }
}

/* 星空閃爍效果 */
#game-area::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: 
        /* 左側閃爍星星 - 更多變化 */
        radial-gradient(circle at 10% 20%, rgba(255, 255, 255, 0.9) 2px, transparent 2px),
        radial-gradient(circle at 25% 40%, rgba(255, 255, 255, 0.7) 1.5px, transparent 1.5px),
        radial-gradient(circle at 15% 60%, rgba(255, 255, 255, 0.8) 1px, transparent 1px),
        radial-gradient(circle at 30% 80%, rgba(255, 255, 255, 0.6) 1.5px, transparent 1.5px),
        radial-gradient(circle at 5% 35%, rgba(255, 255, 255, 0.9) 1.5px, transparent 1.5px),
        radial-gradient(circle at 20% 55%, rgba(255, 255, 255, 0.7) 1px, transparent 1px),
        radial-gradient(circle at 35% 75%, rgba(255, 255, 255, 0.8) 2px, transparent 2px),
        radial-gradient(circle at 8% 45%, rgba(255, 255, 255, 0.6) 1px, transparent 1px),
        
        /* 右側閃爍星星 - 對稱分佈 */
        radial-gradient(circle at 90% 20%, rgba(255, 255, 255, 0.9) 2px, transparent 2px),
        radial-gradient(circle at 75% 40%, rgba(255, 255, 255, 0.7) 1.5px, transparent 1.5px),
        radial-gradient(circle at 85% 60%, rgba(255, 255, 255, 0.8) 1px, transparent 1px),
        radial-gradient(circle at 70% 80%, rgba(255, 255, 255, 0.6) 1.5px, transparent 1.5px),
        radial-gradient(circle at 95% 35%, rgba(255, 255, 255, 0.9) 1.5px, transparent 1.5px),
        radial-gradient(circle at 80% 55%, rgba(255, 255, 255, 0.7) 1px, transparent 1px),
        radial-gradient(circle at 65% 75%, rgba(255, 255, 255, 0.8) 2px, transparent 2px),
        radial-gradient(circle at 92% 45%, rgba(255, 255, 255, 0.6) 1px, transparent 1px);
    background-size: 
        250px 250px, 180px 180px, 200px 200px, 160px 160px, 220px 220px, 140px 140px, 240px 240px, 170px 170px,
        250px 250px, 180px 180px, 200px 200px, 160px 160px, 220px 220px, 140px 140px, 240px 240px, 170px 170px;
    background-position: 
        0 0, 60px 120px, 120px 240px, 180px 360px, 240px 480px, 300px 600px, 360px 720px, 420px 840px,
        0 0, 60px 120px, 120px 240px, 180px 360px, 240px 480px, 300px 600px, 360px 720px, 420px 840px;
    animation: star-twinkle 4s ease-in-out infinite;
    pointer-events: none;
    z-index: 1;
}

@keyframes star-twinkle {
    0%, 100% { opacity: 0.2; }
    25% { opacity: 0.8; }
    50% { opacity: 1; }
    75% { opacity: 0.6; }
}

/* 彩色星星效果 */
#game-area::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: 
        /* 左側彩色星星 */
        radial-gradient(circle at 12% 30%, rgba(0, 255, 255, 0.8) 1.5px, transparent 1.5px),
        radial-gradient(circle at 22% 50%, rgba(255, 0, 255, 0.6) 1px, transparent 1px),
        radial-gradient(circle at 32% 70%, rgba(255, 255, 0, 0.7) 1.5px, transparent 1.5px),
        radial-gradient(circle at 8% 80%, rgba(0, 255, 255, 0.5) 1px, transparent 1px),
        
        /* 右側彩色星星 */
        radial-gradient(circle at 88% 30%, rgba(0, 255, 255, 0.8) 1.5px, transparent 1.5px),
        radial-gradient(circle at 78% 50%, rgba(255, 0, 255, 0.6) 1px, transparent 1px),
        radial-gradient(circle at 68% 70%, rgba(255, 255, 0, 0.7) 1.5px, transparent 1.5px),
        radial-gradient(circle at 92% 80%, rgba(0, 255, 255, 0.5) 1px, transparent 1px);
    background-size: 
        300px 300px, 200px 200px, 250px 250px, 180px 180px,
        300px 300px, 200px 200px, 250px 250px, 180px 180px;
    background-position: 
        0 0, 80px 160px, 160px 320px, 240px 480px,
        0 0, 80px 160px, 160px 320px, 240px 480px;
    animation: colored-star-twinkle 6s ease-in-out infinite;
    pointer-events: none;
    z-index: 1;
}

@keyframes colored-star-twinkle {
    0%, 100% { opacity: 0.1; }
    33% { opacity: 0.6; }
    66% { opacity: 0.3; }
}

/* 確保遊戲畫布在星空背景之上 */
#game-canvas {
    position: relative;
    z-index: 2;
}

/* 3D賽道中心線和深度標記 */
#game-canvas::before {
    content: '';
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    background: 
        /* 網格線條 - 垂直線（超極端向遠方收縮） */
        repeating-linear-gradient(90deg,
            transparent 0%,
            transparent 0.5%,
            rgba(255, 255, 255, 0.1) 0.6%,
            rgba(255, 255, 255, 0.2) 0.7%,
            rgba(255, 255, 255, 0.3) 0.8%,
            rgba(255, 255, 255, 0.4) 0.9%,
            rgba(255, 255, 255, 0.5) 1%,
            rgba(255, 255, 255, 0.6) 1.1%,
            rgba(255, 255, 255, 0.7) 1.2%,
            rgba(255, 255, 255, 0.8) 1.3%,
            rgba(255, 255, 255, 0.9) 1.4%,
            rgba(255, 255, 255, 1) 1.5%,
            rgba(255, 255, 255, 0.9) 1.6%,
            rgba(255, 255, 255, 0.8) 1.7%,
            rgba(255, 255, 255, 0.7) 1.8%,
            rgba(255, 255, 255, 0.6) 1.9%,
            rgba(255, 255, 255, 0.5) 2%,
            rgba(255, 255, 255, 0.4) 2.1%,
            rgba(255, 255, 255, 0.3) 2.2%,
            rgba(255, 255, 255, 0.2) 2.3%,
            rgba(255, 255, 255, 0.1) 2.4%,
            transparent 2.5%
        ),
        /* 網格線條 - 水平線（超極端向遠方收縮） */
        repeating-linear-gradient(180deg,
            transparent 0%,
            transparent 0.4%,
            rgba(255, 255, 255, 0.1) 0.5%,
            rgba(255, 255, 255, 0.2) 0.6%,
            rgba(255, 255, 255, 0.3) 0.7%,
            rgba(255, 255, 255, 0.4) 0.8%,
            rgba(255, 255, 255, 0.5) 0.9%,
            rgba(255, 255, 255, 0.6) 1%,
            rgba(255, 255, 255, 0.7) 1.1%,
            rgba(255, 255, 255, 0.8) 1.2%,
            rgba(255, 255, 255, 0.9) 1.3%,
            rgba(255, 255, 255, 1) 1.4%,
            rgba(255, 255, 255, 0.9) 1.5%,
            rgba(255, 255, 255, 0.8) 1.6%,
            rgba(255, 255, 255, 0.7) 1.7%,
            rgba(255, 255, 255, 0.6) 1.8%,
            rgba(255, 255, 255, 0.5) 1.9%,
            rgba(255, 255, 255, 0.4) 2%,
            rgba(255, 255, 255, 0.3) 2.1%,
            rgba(255, 255, 255, 0.2) 2.2%,
            rgba(255, 255, 255, 0.1) 2.3%,
            transparent 2.4%
        ),
        /* 中心線 - 強化延伸效果 */
        linear-gradient(90deg,
            transparent 48%,
            rgba(0, 255, 255, 0.2) 49%,
            rgba(0, 255, 255, 0.4) 49.5%,
            rgba(0, 255, 255, 0.6) 50%,
            rgba(0, 255, 255, 0.7) 52%,
            rgba(0, 255, 255, 0.8) 55%,
            rgba(0, 255, 255, 0.85) 60%,
            rgba(0, 255, 255, 0.9) 65%,
            rgba(0, 255, 255, 0.95) 70%,
            rgba(0, 255, 255, 1) 75%,
            rgba(0, 255, 255, 1) 80%,
            rgba(0, 255, 255, 0.95) 80.5%,
            transparent 81%
        );
    background-size: 100% 800%, 100% 500%, 100% 100%, 100% 600%, 100% 400%, 100% 200%;
    background-position: 0 0;
    pointer-events: none;
    z-index: 2;
    transform: perspective(300px) rotateX(30deg);
    transform-origin: center bottom;
    animation: track-flow 2s linear infinite;
}

/* 賽道流動動畫 - 超極端收縮效果 */
@keyframes track-flow {
    0% {
        background-position: 0 0, 0 0, 0 0, 0 0, 0 0, 0 0;
        opacity: 0.8;
    }
    50% {
        background-position: 0 -400px, 0 -250px, 0 -50px, 0 -300px, 0 -200px, 0 -100px;
        opacity: 1;
    }
    100% {
        background-position: 0 -800px, 0 -500px, 0 -100px, 0 -600px, 0 -400px, 0 -200px;
        opacity: 0.8;
    }
}

/* 額外3D透視增強效果 */
#game-canvas {
    position: relative;
    z-index: 2;
}

#game-canvas::after {
    content: '';
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    background: 
        /* 賽道側邊陰影 - 增強3D感 */
        linear-gradient(90deg,
            rgba(0, 0, 0, 0.4) 0%,
            rgba(0, 0, 0, 0.2) 15%,
            transparent 20%,
            transparent 80%,
            rgba(0, 0, 0, 0.2) 85%,
            rgba(0, 0, 0, 0.4) 100%
        ),
        /* 遠方光點效果 */
        radial-gradient(circle at 50% 20%, rgba(0, 255, 255, 0.3) 0%, transparent 50%),
        radial-gradient(circle at 50% 40%, rgba(0, 255, 255, 0.2) 0%, transparent 40%),
        radial-gradient(circle at 50% 60%, rgba(0, 255, 255, 0.1) 0%, transparent 30%);
    pointer-events: none;
    z-index: 1;
    transform: perspective(300px) rotateX(30deg);
    transform-origin: center bottom;
    animation: distant-glow 4s ease-in-out infinite;
}

@keyframes distant-glow {
    0%, 100% { opacity: 0.3; }
    50% { opacity: 0.7; }
}

/* 其他細節微調 */
#key-hints .key {
    background: rgba(255,255,255,0.25);
    color: #0ff;
    border-radius: 10px;
    font-size: 1.2rem;
    font-family: 'Orbitron', 'Audiowide', Arial, sans-serif;
    box-shadow: 0 0 8px #0ff;
    border: 1.5px solid #0ff;
}

#combo-container {
    filter: drop-shadow(0 0 10px #fff700) drop-shadow(0 0 6px #0ff);
}

/* 讓選單、結算畫面也有玻璃感 */
#select-area, #result-screen {
    background: rgba(24,26,42,0.85);
    border-radius: 24px;
    box-shadow: 0 4px 32px 0 rgba(0,0,0,0.18);
    backdrop-filter: blur(8px);
    border: 1.5px solid rgba(255,255,255,0.10);
    color: #fff;
}

/* 讓按鈕更現代感 */
button, .action-btn {
    background: linear-gradient(90deg, #0ff 0%, #23235a 100%);
    color: #fff;
    border-radius: 12px;
    border: none;
    font-family: 'Orbitron', 'Audiowide', Arial, sans-serif;
    font-weight: bold;
    font-size: 1.1rem;
    box-shadow: 0 2px 12px 0 rgba(0,0,0,0.08);
    padding: 0.7rem 2.2rem;
    margin: 0.5rem;
    transition: background 0.2s, color 0.2s, box-shadow 0.2s;
}
button:hover, .action-btn:hover {
    background: linear-gradient(90deg, #fff700 0%, #0ff 100%);
    color: #000;
    box-shadow: 0 4px 24px 0 rgba(0,255,255,0.18);
} 

/* 按鍵高亮效果 - 每個按鍵不同顏色 */
.key.active[data-key="D"], .key:active[data-key="D"] {
    background: linear-gradient(135deg, #00CFFF, #0088FF);
    border-color: #00CFFF;
    color: #fff;
    box-shadow: 
        0 0 30px rgba(0,207,255,0.8),
        0 0 60px rgba(0,136,255,0.6),
        inset 0 0 20px rgba(0,207,255,0.3);
    transform: scale(0.9);
    animation: key-press-blue 0.15s ease-out;
    text-shadow: 0 0 10px #00CFFF;
}

.key.active[data-key="F"], .key:active[data-key="F"] {
    background: linear-gradient(135deg, #A16EFF, #8A2BE2);
    border-color: #A16EFF;
    color: #fff;
    box-shadow: 
        0 0 30px rgba(161,110,255,0.8),
        0 0 60px rgba(138,43,226,0.6),
        inset 0 0 20px rgba(161,110,255,0.3);
    transform: scale(0.9);
    animation: key-press-purple 0.15s ease-out;
    text-shadow: 0 0 10px #A16EFF;
}

.key.active[data-key=" "], .key:active[data-key=" "] {
    background: linear-gradient(135deg, #0ff 60%, #1C1C80 100%);
    border: 3px solid #0ff;
    color: #0ff;
    box-shadow: 0 0 32px 8px #0ff, 0 0 64px 16px #39f, 0 0 0px 0px #fff;
    text-shadow: 0 0 12px #0ff, 0 0 24px #39f;
    font-weight: bold;
    letter-spacing: 6px;
    font-size: 2.1rem;
    filter: brightness(1.3);
    animation: space-neon-glow 0.18s cubic-bezier(.4,2,.6,1) 1;
    transform: scale(1.05);
}

@keyframes space-neon-glow {
    0% {
        box-shadow: 0 0 0px 0px #0ff, 0 0 0px 0px #39f;
        border-color: #fff;
        filter: brightness(1.0);
        transform: scale(1.0);
    }
    60% {
        box-shadow: 0 0 48px 16px #0ff, 0 0 96px 32px #39f;
        border-color: #0ff;
        filter: brightness(1.5);
        transform: scale(1.08);
    }
    100% {
        box-shadow: 0 0 32px 8px #0ff, 0 0 64px 16px #39f;
        border-color: #0ff;
        filter: brightness(1.3);
        transform: scale(1.05);
    }
}

.key.active[data-key="J"], .key:active[data-key="J"] {
    background: linear-gradient(135deg, #FF8888, #FF6B6B);
    border-color: #FF8888;
    color: #fff;
    box-shadow: 
        0 0 30px rgba(255,136,136,0.8),
        0 0 60px rgba(255,107,107,0.6),
        inset 0 0 20px rgba(255,136,136,0.3);
    transform: scale(0.9);
    animation: key-press-pink 0.15s ease-out;
    text-shadow: 0 0 10px #FF8888;
}

.key.active[data-key="K"], .key:active[data-key="K"] {
    background: linear-gradient(135deg, #66FFFF, #00FFFF);
    border-color: #66FFFF;
    color: #000;
    box-shadow: 
        0 0 30px rgba(102,255,255,0.8),
        0 0 60px rgba(0,255,255,0.6),
        inset 0 0 20px rgba(102,255,255,0.3);
    transform: scale(0.9);
    animation: key-press-cyan 0.15s ease-out;
    text-shadow: 0 0 10px #66FFFF;
}

/* 各按鍵的動畫效果 */
@keyframes key-press-blue {
    0% { 
        transform: scale(1);
        box-shadow: 0 0 8px #00CFFF;
    }
    50% { 
        transform: scale(0.85);
        box-shadow: 
            0 0 40px rgba(0,207,255,0.9),
            0 0 80px rgba(0,136,255,0.7);
    }
    100% { 
        transform: scale(0.9);
        box-shadow: 
            0 0 30px rgba(0,207,255,0.8),
            0 0 60px rgba(0,136,255,0.6);
    }
}

@keyframes key-press-purple {
    0% { 
        transform: scale(1);
        box-shadow: 0 0 8px #A16EFF;
    }
    50% { 
        transform: scale(0.85);
        box-shadow: 
            0 0 40px rgba(161,110,255,0.9),
            0 0 80px rgba(138,43,226,0.7);
    }
    100% { 
        transform: scale(0.9);
        box-shadow: 
            0 0 30px rgba(161,110,255,0.8),
            0 0 60px rgba(138,43,226,0.6);
    }
}

@keyframes key-press-gold {
    0% { 
        transform: scale(1);
        box-shadow: 0 0 8px #FFD700;
    }
    50% { 
        transform: scale(0.85);
        box-shadow: 
            0 0 40px rgba(255,215,0,0.9),
            0 0 80px rgba(255,165,0,0.7);
    }
    100% { 
        transform: scale(0.9);
        box-shadow: 
            0 0 30px rgba(255,215,0,0.8),
            0 0 60px rgba(255,165,0,0.6);
    }
}

@keyframes key-press-pink {
    0% { 
        transform: scale(1);
        box-shadow: 0 0 8px #FF8888;
    }
    50% { 
        transform: scale(0.85);
        box-shadow: 
            0 0 40px rgba(255,136,136,0.9),
            0 0 80px rgba(255,107,107,0.7);
    }
    100% { 
        transform: scale(0.9);
        box-shadow: 
            0 0 30px rgba(255,136,136,0.8),
            0 0 60px rgba(255,107,107,0.6);
    }
}

@keyframes key-press-cyan {
    0% { 
        transform: scale(1);
        box-shadow: 0 0 8px #66FFFF;
    }
    50% { 
        transform: scale(0.85);
        box-shadow: 
            0 0 40px rgba(102,255,255,0.9),
            0 0 80px rgba(0,255,255,0.7);
    }
    100% { 
        transform: scale(0.9);
        box-shadow: 
            0 0 30px rgba(102,255,255,0.8),
            0 0 60px rgba(0,255,255,0.6);
    }
} 

/* === 難度等級專屬樣式 === */
.difficulty-btn.beginner { background: linear-gradient(90deg, #b2fefa, #e0c3fc); color: #222; }
.difficulty-btn.casual      { background: linear-gradient(90deg, #a8ff78, #78ffd6); color: #222; }
.difficulty-btn.hard    { background: linear-gradient(90deg, #43cea2, #185a9d); color: #fff; }
.difficulty-btn.extreme      { background: linear-gradient(90deg, #ffaf7b, #d76d77); color: #fff; }
.difficulty-btn.master    { background: linear-gradient(90deg, #f7971e, #ffd200); color: #fff; }
.difficulty-btn.fate     { background: linear-gradient(90deg, #f953c6, #b91d73); color: #fff; border: 2px solid #fff700; box-shadow: 0 0 16px #fff70088; }

/* 星星顏色與特效 */
.difficulty-btn .star         { color: #ffe066; text-shadow: 0 0 8px #ffe06688; }
.difficulty-btn.fate .star    { color: #fff700; text-shadow: 0 0 12px #fff700cc; }
.difficulty-btn .star-locked  { color: #888; text-shadow: none; }
.difficulty-btn.fate .star:last-child {
    animation: star-glow 1.2s infinite alternate;
}
@keyframes star-glow {
    0%   { text-shadow: 0 0 8px #fff700, 0 0 16px #fff70088; }
    100% { text-shadow: 0 0 24px #fff700, 0 0 32px #fff700cc; }
}

/* 按鍵提示 - SPACE 鍵特殊樣式 */
.key[data-key=" "] {
    background: linear-gradient(90deg, #fff700 60%, #ffe066 100%);
    color: #222;
    border: 2px solid #ffe066;
    font-weight: bold;
    min-width: 80px;
    letter-spacing: 2px;
    box-shadow: 0 0 8px #fff70088;
}

/* 判定區間視覺提示（需配合JS切換class） */
.judge-window {
    position: absolute;
    left: 0;
    right: 0;
    height: 40px;
    background: rgba(0,255,255,0.08);
    border-top: 1.5px dashed #0ff;
    border-bottom: 1.5px dashed #0ff;
    pointer-events: none;
    z-index: 2;
    transition: height 0.3s;
}
.judge-window.beginner { height: 70px; }
.judge-window.casual { height: 60px; }
.judge-window.hard { height: 50px; }
.judge-window.extreme { height: 40px; }
.judge-window.master { height: 30px; }
.judge-window.fate { height: 20px; }

/* 難度說明 tooltip 強化 */

.difficulty-btn.final .tooltip {
    background: #2a1b3d;
    color: #fff700;
    border: 2px solid #fff700;
    box-shadow: 0 0 16px #fff70088;
} 

.high-contrast, body.high-contrast {
    background: #000 !important;
    color: #fff !important;
}
.high-contrast #main-wrapper,
.high-contrast #select-area,
.high-contrast #game-area,
.high-contrast #result-screen {
    background: #000 !important;
    color: #fff !important;
    border: 2px solid #fff700 !important;
}
.high-contrast .song-card,
.high-contrast .difficulty-btn,
.high-contrast .action-btn {
    background: #111 !important;
    color: #fff !important;
    border: 2px solid #fff700 !important;
    box-shadow: 0 0 8px #fff700cc !important;
}
.high-contrast .key {
    background: #fff700 !important;
    color: #000 !important;
    border: 2px solid #fff !important;
}
.high-contrast .star, .high-contrast .difficulty-stars {
    color: #fff700 !important;
    text-shadow: 0 0 8px #fff700cc !important;
} 

#loading-overlay {
    display: flex;
    align-items: center;
    justify-content: center;
}
.loader {
    border: 8px solid #222;
    border-top: 8px solid #fff700;
    border-radius: 50%;
    width: 80px;
    height: 80px;
    animation: spin-loader 1s linear infinite;
    box-shadow: 0 0 32px #fff70088;
}
@keyframes spin-loader {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
} 

.difficulty-btn .tooltip {
  display: none;
  position: absolute;
  top: 110%;
  left: 50%;
  transform: translateX(-50%);
  background: #222;
  color: #ffe066;
  border: 1.5px solid #ffe066;
  border-radius: 10px;
  padding: 0.7em 1.2em;
  font-size: 0.95rem;
  font-family: 'Orbitron', 'Audiowide', '微軟正黑體', Arial, sans-serif;
  font-weight: bold;
  letter-spacing: 0.05em;
  line-height: 1.4;
  white-space: pre-line;
  z-index: 10;
  box-shadow: 0 0 12px #ffe06644;
  pointer-events: none;
  text-align: left;
  width: 220px;
}
.difficulty-btn:hover .tooltip,
.difficulty-btn:focus .tooltip {
  display: block;
  animation: fadeIn 0.3s ease-in-out;
}
@keyframes fadeIn {
  0%   { opacity: 0; transform: translateX(-50%) scale(0.95); }
  100% { opacity: 1; transform: translateX(-50%) scale(1); }
}
.difficulty-btn .tooltip::after {
  content: "";
  position: absolute;
  top: -8px;
  left: 50%;
  transform: translateX(-50%);
  border: 8px solid transparent;
  border-bottom-color: #222;
}

.difficulty-desc {
    display: none;
}
.difficulty-btn:hover .difficulty-desc {
    display: block;
}
.difficulty-btn:active .difficulty-desc,
.difficulty-btn.active .difficulty-desc {
    display: none !important;
}

/* 分數加分提示動畫 */
#score-display {
  position: relative;
  display: inline-block;
}
.score-gain-tip {
  position: absolute;
  left: 100%;
  top: 50%;
  transform: translate(10px, -50%) scale(1);
  margin: 0;
  font-size: 1.2em;
  color: #fffa70;
  font-weight: bold;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s, transform 0.7s cubic-bezier(0.4,1.4,0.6,1);
  text-shadow: 0 0 8px #fff700, 0 0 16px #fffa70;
  z-index: 2;
  white-space: nowrap;
}
.score-gain-tip.show {
  opacity: 1;
  transform: translate(30px, -80%) scale(1.2);
  transition: opacity 0.2s, transform 0.7s cubic-bezier(0.4,1.4,0.6,1);
}

/* ====== 結算畫面動畫與美化 ====== */
.result-content {
  animation: fadeIn 0.8s cubic-bezier(.4,2,.6,1) both;
  background: linear-gradient(135deg, rgba(24,26,42,0.7) 0%, rgba(35,35,90,0.7) 100%);
  border-radius: 24px;
  box-shadow: 0 0 32px #0ff4, 0 0 8px #ffe06688;
  margin: 0 auto;
  max-width: 480px;
}
.result-title {
  font-size: 2.1rem;
  color: #fff700;
  text-shadow: 0 0 18px #ffe066,0 0 8px #fff;
  margin-bottom: 8px;
  letter-spacing: 2px;
  font-weight: bold;
  animation: fadeIn 1s;
}
.final-score {
  font-size: 2.8rem;
  font-weight: bold;
  color: #ffe066;
  text-shadow: 0 0 24px #ffe066,0 0 8px #fff;
  letter-spacing: 2px;
  margin: 18px 0 8px 0;
  transition: color 0.3s;
  animation: score-pop 1.2s cubic-bezier(.4,2,.6,1);
}
@keyframes score-pop {
  0% { transform: scale(0.7); opacity: 0; }
  60% { transform: scale(1.15); opacity: 1; }
  100% { transform: scale(1); opacity: 1; }
}
.final-grade {
  font-size: 2.2rem;
  font-weight: bold;
  margin-bottom: 8px;
  color: #fff700;
  text-shadow: 0 0 24px #fff700,0 0 8px #fff;
  letter-spacing: 2px;
  transition: color 0.3s;
}
.grade-animate {
  animation: grade-bounce 1.1s cubic-bezier(.4,2,.6,1);
}
@keyframes grade-bounce {
  0% { transform: scale(0.5); opacity: 0; }
  60% { transform: scale(1.3); opacity: 1; }
  100% { transform: scale(1); opacity: 1; }
}
.grade-glow {
  animation: grade-glow-anim 1.2s infinite alternate;
}
@keyframes grade-glow-anim {
  0% { text-shadow: 0 0 24px #fff700,0 0 8px #ffffff; color: #fff700; }
  100% { text-shadow: 0 0 48px #ffe066,0 0 16px #ffffff; color: #ffe066; }
}
.final-combo {
  font-size: 1.3rem;
  color: #0ff;
  margin-bottom: 8px;
  text-shadow: 0 0 8px #0ff8;
}
.final-badge {
  font-size: 1.2rem;
  margin-bottom: 12px;
  text-align: center;
  animation: badge-pop 1.1s cubic-bezier(.4,2,.6,1);
}
@keyframes badge-pop {
  0% { transform: scale(0.7); opacity: 0; }
  60% { transform: scale(1.2); opacity: 1; }
  100% { transform: scale(1); opacity: 1; }
}
.result-leaderboard {
  width: 100%;
  max-width: 420px;
  margin: 18px auto 0 auto;
  background: #000000b3;
  border-radius: 16px;
  padding: 16px 8px 8px 8px;
  box-shadow: 0 0 24px #00ffff33;
  animation: fadeIn 1.2s;
}
.result-leaderboard table {
  width: 100%;
  border-collapse: collapse;
  background: rgba(0,0,0,0.5);
}
.result-leaderboard tr.slide-in-left {
  animation: slideInLeft 0.7s cubic-bezier(.4,2,.6,1);
}
.result-leaderboard tr.slide-in-right {
  animation: slideInRight 0.7s cubic-bezier(.4,2,.6,1);
}
@keyframes slideInLeft {
  0% { transform: translateX(-60px); opacity: 0; }
  100% { transform: translateX(0); opacity: 1; }
}
@keyframes slideInRight {
  0% { transform: translateX(60px); opacity: 0; }
  100% { transform: translateX(0); opacity: 1; }
}
.result-buttons {
  display: flex;
  flex-direction: row;
  gap: 18px;
  margin-top: 24px;
  justify-content: center;
}
.action-btn {
  padding: 10px 32px;
  font-size: 1.2em;
  border-radius: 12px;
  font-weight: bold;
  border: none;
  cursor: pointer;
  box-shadow: 0 0 12px #ffe06688;
  transition: transform 0.18s, box-shadow 0.18s;
}
.action-btn:active {
  transform: scale(0.95);
  box-shadow: 0 0 4px #ffe06688;
}
.action-btn:hover {
  filter: brightness(1.1);
  box-shadow: 0 0 24px #ffe066cc;
}
.action-btn + .action-btn {
  background: #00ffff;
  color: #222;
  box-shadow: 0 0 12px #00ffff88;
}
.action-btn + .action-btn:hover {
  box-shadow: 0 0 24px #00ffff;
}

@media (max-width: 600px) {
  .result-content { max-width: 98vw; padding: 12px 0; }
  .result-leaderboard { max-width: 98vw; }
  .final-score { font-size: 2rem; }
  .final-grade { font-size: 1.3rem; }
}

/* ====== 結算畫面根據評級自動變色 ====== */
body.result-bg-ss {
  background: radial-gradient(circle at 50% 40%, #fffbe6 0%, #ffe066 40%, #ffd700 70%, #0a0a1a 100%) !important;
}
body.result-bg-ab {
  background: radial-gradient(circle at 50% 40%, #e0f7fa 0%, #0ff 40%, #1c1c80 80%, #0a0a1a 100%) !important;
}
body.result-bg-d {
  background: radial-gradient(circle at 50% 40%, #e0f7fa 0%, #b2ebf2 40%, #1c1c80 80%, #0a0a1a 100%) !important;
}
body.result-bg-ss::before {
  content: '';
  position: fixed;
  top: 0; left: 0; width: 100vw; height: 100vh;
  z-index: -1;
  pointer-events: none;
  opacity: 0.7;
  background: radial-gradient(circle at 50% 60%, rgba(255, 224, 102, 0.5) 0%, rgba(255, 215, 0, 0.2) 60%, transparent 100%);
}
body.result-bg-ab::before {
  content: '';
  position: fixed;
  top: 0; left: 0; width: 100vw; height: 100vh;
  z-index: -1;
  pointer-events: none;
  opacity: 0.7;
  background: radial-gradient(circle at 50% 60%, rgba(0,255,255,0.18) 0%, rgba(76,220,196,0.12) 60%, transparent 100%);
}
body.result-bg-d::before {
  content: '';
  position: fixed;
  top: 0; left: 0; width: 100vw; height: 100vh;
  z-index: -1;
  pointer-events: none;
  opacity: 0.7;
  background: radial-gradient(circle at 50% 60%, rgba(178,235,242,0.12) 0%, rgba(28,28,128,0.08) 60%, transparent 100%);
}

.result-detail {
    font-size: 1.1rem;
    color: #fff;
    margin-bottom: 10px;
    line-height: 1.6;
    text-align: center;
}
.result-detail span {
    margin-right: 8px;
}

.left-top-btn {
    position: absolute;
    left: 1rem;
    width: 160px;
    text-align: center;
    white-space: nowrap;
    z-index: 10;
    box-sizing: border-box;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0;
    padding: 0;
}
.left-top-btn[type="range"] {
    height: 48px;
    background: transparent;
    margin: 0;
    padding: 8px;
}
#volume-slider.left-top-btn {
    top: 1rem;
}
#contrast-btn.left-top-btn {
    top: 1rem;
}
#help-btn.left-top-btn {
    top: calc(1rem + 48px + 4px);
}
#leaderboard-btn.left-top-btn {
    top: calc(1rem + 2 * (48px + 4px));
}
#achievement-btn.left-top-btn {
    top: calc(1rem + 3 * (48px + 4px));
}
#clear-storage-btn.left-top-btn,
#team-btn.left-top-btn {
    position: relative;
    display: block;
    width: 180px;
    margin: 0.5rem auto 0.2rem auto;
    font-size: 1.1rem;
    letter-spacing: 1px;
    z-index: 20;
    box-shadow: 0 0 16px #0ff4, 0 0 2px #fff;
    text-align: center;
    outline: none;
    cursor: pointer;
    user-select: none;
    transition: box-shadow 0.2s, background 0.2s;
}

/* 移除個別 top 定位，統一用 block/margin 垂直排列 */
#clear-storage-btn.left-top-btn,
#team-btn.left-top-btn {
    top: unset !important;
}

/* ====== 團隊成員介紹樣式 ====== */
.team-member {
    background: linear-gradient(135deg, rgba(24,26,42,0.8) 0%, rgba(35,35,90,0.9) 100%);
    border: 2px solid rgba(0,255,255,0.3);
    border-radius: 16px;
    padding: 20px;
    margin: 16px 0;
    box-shadow: 0 4px 20px rgba(0,255,255,0.2);
    transition: all 0.3s ease;
    backdrop-filter: blur(8px);
}

.team-member:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 30px rgba(0,255,255,0.4);
    border-color: rgba(0,255,255,0.6);
}

.member-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 12px;
    padding-bottom: 8px;
    border-bottom: 1px solid rgba(0,255,255,0.2);
}

.member-emoji {
    font-size: 1.8rem;
    filter: drop-shadow(0 0 8px rgba(0,255,255,0.6));
}

.member-name {
    font-size: 1.3rem;
    font-weight: bold;
    color: #0ff;
    text-shadow: 0 0 10px rgba(0,255,255,0.5);
}

.member-title {
    font-size: 1.3rem;
    color: #fff;
    opacity: 1;
    font-style: normal;
}

.member-description {
    color: #fff;
    font-size: 1rem;
    line-height: 1.6;
    text-align: left;
    opacity: 0.9;
}

/* 響應式設計 */
@media (max-width: 768px) {
    .team-member {
        padding: 16px;
        margin: 12px 0;
    }
    
    .member-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
    }
    
    .member-name {
        font-size: 1.1rem;
    }
    
    .member-title {
        font-size: 0.9rem;
    }
    
    .member-description {
        font-size: 0.95rem;
    }
}

.team-title {
    font-size: 2.3rem;
    font-family: 'Orbitron', 'Audiowide', '微軟正黑體', Arial, sans-serif;
    font-weight: bold;
    letter-spacing: 0.12em;
    background: linear-gradient(90deg, #0ff 10%, #f0f 40%, #fff700 70%, #ff6f91 100%);
    background-size: 300% 100%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    /* text-fill-color: transparent; 這行已移除 */
    text-shadow:
        0 0 18px #fff700,
        0 0 32px #0ff,
        0 0 48px #f0f,
        0 0 64px #ff6f91;
    animation: team-title-glow 3s linear infinite, team-title-rainbow 5s linear infinite;
    margin-bottom: 1.2em;
    text-align: center;
}

@keyframes team-title-glow {
    0%, 100% {
        text-shadow:
            0 0 18px #fff700,
            0 0 32px #0ff,
            0 0 48px #f0f,
            0 0 64px #ff6f91;
    }
    50% {
        text-shadow:
            0 0 32px #f0f,
            0 0 48px #0ff,
            0 0 64px #fff700,
            0 0 80px #ff6f91;
    }
}
@keyframes team-title-rainbow {
    0% { background-position: 0% 50%; }
    100% { background-position: 100% 50%; }
}

.project-story {
    margin: 1.5em 0;
    padding: 1.2em 1em;
    background: linear-gradient(135deg, rgba(24,26,42,0.7) 0%, rgba(35,35,90,0.8) 100%);
    border-radius: 18px;
    box-shadow: 0 0 24px #0ff4, 0 0 8px #ffe06688;
    color: #fff;
    font-size: 1.08em;
    line-height: 1.8;
}
.story-intro {
    display: flex;
    align-items: flex-start;
    gap: 1.2em;
    margin-bottom: 1em;
    font-size: 1.2em;
    flex-wrap: wrap;
}
.story-icon {
    font-size: 2.5em;
    filter: drop-shadow(0 0 8px #0ff8);
    margin-top: 0.1em;
}
.story-title-group {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    min-width: 180px;
}
.story-title-main {
    font-size: 2.1em;
    font-family: 'Orbitron', 'Audiowide', '微軟正黑體', Arial, sans-serif;
    font-weight: bold;
    color: #0ff;
    text-shadow: 0 0 18px #0ff, 0 0 32px #0ff8;
    line-height: 1.1;
    letter-spacing: 0.05em;
}
.story-title-sub {
    font-size: 1.4em;
    color: #0ff;
    font-weight: bold;
    text-shadow: 0 0 10px #0ff8;
    margin-top: 0.2em;
    line-height: 1.1;
    letter-spacing: 0.05em;
}
.story-desc {
    flex: 1;
    color: #ffe066;
    font-style: italic;
    font-size: 1.1em;
    margin-left: 1.5em;
    margin-top: 0.2em;
    align-self: flex-start;
    line-height: 1.7;
    max-width: 60%;
}
@media (max-width: 700px) {
    .story-intro {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5em;
    }
    .story-desc {
        margin-left: 0;
        max-width: 100%;
    }
}

.story-list ul {
    margin: 0.3em 0 0.7em 1.2em;
    padding-left: 1.2em;
    list-style: disc;
    line-height: 1.6;
}

.story-list ul, .story-section ul {
    line-height: 1.35;
}
.story-section-title {
    margin-bottom: 0.5em;
}
.story-section ul {
    margin-top: 0;
}
